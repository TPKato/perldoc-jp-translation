
=encoding utf8

=head1 NAME

=begin original

perl5160delta - what is new for perl v5.16.0

=end original

perl5160delta - perl v5.16.0 での変更点

=head1 DESCRIPTION

=begin original

This document describes differences between the 5.14.0 release and
the 5.16.0 release.

=end original

この文書は 5.14.0 リリースと 5.16.0 リリースの変更点を記述しています。

=begin original

If you are upgrading from an earlier release such as 5.12.0, first read
L<perl5140delta>, which describes differences between 5.12.0 and
5.14.0.

=end original

5.12.0 のような以前のリリースから更新する場合は、まず 5.12.0 と
5.14.0 の違いについて記述している L<perl5140delta> を読んでください。

=head1 Notice

=begin original

As described in L<perlpolicy>, the release of Perl 5.16.0 marks the
official end of support for Perl 5.12.  Users of Perl 5.12 or earlier
should consider upgrading to a more recent release of Perl.

=end original

As described in L<perlpolicy>, the release of Perl 5.16.0 marks the
official end of support for Perl 5.12.  Users of Perl 5.12 or earlier
should consider upgrading to a more recent release of Perl.
(TBT)

=head1 Core Enhancements

(コアの拡張)

=head2 C<use I<VERSION>>

=begin original

As of this release, version declarations like C<use v5.16> now disable
all features before enabling the new feature bundle.  This means that
the following holds true:

=end original

このリリース以降、C<use v5.16> のようなバージョン宣言は、新しい機能が
有効になる前の全ての機能が無効になるようになりました。
これは、以下のようなものが真であることを意味します:

    use 5.016;
    # only 5.16 features enabled here
    use 5.014;
    # only 5.14 features enabled here (not 5.16)

=begin original

C<use v5.12> and higher continue to enable strict, but explicit C<use
strict> and C<no strict> now override the version declaration, even
when they come first:

=end original

C<use v5.12> 以上は strict を有効にするという機能ははそのままですが、
明示的な C<use strict> と C<no strict> は (先に現れても) バージョン定義を
上書きするようになりました:

    no strict;
    use 5.012;
    # no strict here

=begin original

There is a new ":default" feature bundle that represents the set of
features enabled before any version declaration or C<use feature> has
been seen.  Version declarations below 5.10 now enable the ":default"
feature set.  This does not actually change the behaviour of C<use
v5.8>, because features added to the ":default" set are those that were
traditionally enabled by default, before they could be turned off.

=end original

新しい ":default" 機能は、任意のバージョン定義や C<use feature> が
現れる前に有効な機能の集合を表現します。
5.10 以前のバージョン宣言は ":default" 機能集合を有効にするように
なりました。
これは実際には C<use v5.8> の振る舞いを変更しません; なぜなら
":default" 集合は、機能を無効に出来るようになる前に伝統的にデフォルトで
有効になっていたものだからです。

=begin original

C<< no feature >> now resets to the default feature set.  To disable all
features (which is likely to be a pretty special-purpose request, since
it presumably won't match any named set of semantics) you can now  
write C<< no feature ':all' >>.

=end original

C<< no feature >> はデフォルト機能集合をリセットするようになりました。
全ての機能を無効にする (これはかなり特殊な用途の要求です; なぜなら
おそらく動作の全ての名前付き集合にマッチングしないからです) には、
C<< no feature ':all' >> と書けるようになります。

=begin original

C<$[> is now disabled under C<use v5.16>.  It is part of the default
feature set and can be turned on or off explicitly with C<use feature
'array_base'>.

=end original

C<$[> は C<use v5.16> の元では無効になるようになりました。
これはデフォルト機能集合の一部で、 C<use feature 'array_base'> によって
明示的に有効無効を切り替えられます。

=head2 C<__SUB__>

=begin original

The new C<__SUB__> token, available under the C<current_sub> feature
(see L<feature>) or C<use v5.16>, returns a reference to the current
subroutine, making it easier to write recursive closures.

=end original

C<current_sub> 機能 (L<feature> 参照) または C<use v5.16> で利用可能な
C<__SUB__> トークンは現在のサブルーチンへのリファレンスを返すことで、
再帰クロージャを書くのを容易にします。

=head2 New and Improved Built-ins

(新規または改良された組み込み関数)

=head3 More consistent C<eval>

(より一貫性のある C<eval>)

=begin original

The C<eval> operator sometimes treats a string argument as a sequence of
characters and sometimes as a sequence of bytes, depending on the
internal encoding.  The internal encoding is not supposed to make any
difference, but there is code that relies on this inconsistency.

=end original

C<eval> 演算子は内部エンコーディングに依存して、時には文字列引数を
文字の並びとして、時にはバイトの並びとして扱います。
内部エンコーディングは何の違いもないはずですが、この非一貫性に依存した
コードがあります。

=begin original

The new C<unicode_eval> and C<evalbytes> features (enabled under C<use
5.16.0>) resolve this.  The C<unicode_eval> feature causes C<eval
$string> to treat the string always as Unicode.  The C<evalbytes>
features provides a function, itself called C<evalbytes>, which
evaluates its argument always as a string of bytes.

=end original

(C<use 5.16.0> で有効になる)新しい C<unicode_eval> 機能と
C<evalbytes> 機能はこれを解決します。
C<unicode_eval> 機能は、C<eval $string> での文字列を常に Unicode として
扱います。
C<evalbytes> 機能は、引数を常にバイト列として扱う C<evalbytes> 関数を
提供します。

=begin original

These features also fix oddities with source filters leaking to outer
dynamic scopes.

=end original

これらの機能は、ソースフィルタが外側の動的スコープにリークする問題も
修正します。

=begin original

See L<feature> for more detail.

=end original

さらなる詳細については L<feature> を参照してください。

=head3 C<substr> lvalue revamp

(C<substr> 左辺値の刷新)

=for comment Does this belong here, or under Incomptable Changes?

=begin original

When C<substr> is called in lvalue or potential lvalue context with two
or three arguments, a special lvalue scalar is returned that modifies
the original string (the first argument) when assigned to.

=end original

左辺値や潜在的な左辺値コンテキストで 2 引数または 3 引数の C<substr> が
呼び出されると、代入するときに元の文字列(1 番目の引数)を修正する
特殊な左辺値スカラを返します。

=begin original

Previously, the offsets (the second and third arguments) passed to
C<substr> would be converted immediately to match the string, negative
offsets being translated to positive and offsets beyond the end of the
string being truncated.

=end original

以前は、C<substr> に渡されたオフセット(2 番目と 3 番目の引数) は直ちに
文字列にマッチするように変換され、負のオフセットは正に変換され、
文字列の末尾を越えるオフセットは切り詰められました。

=begin original

Now, the offsets are recorded without modification in the special
lvalue scalar that is returned, and the original string is not even
looked at by C<substr> itself, but only when the returned lvalue is
read or modified.

=end original

今では、オフセットは返される特殊左辺値スカラに修正なしに記録され、
元の文字列は C<substr> 自身によっても見ませんが、返された左辺値は
読んだり修正したりしたときだけです。

=begin original

These changes result in an incompatible change:

=end original

これらの変更はいくつかの互換性のない変更を引き起こします:

=begin original

If the original string changes length after the call to C<substr> but
before assignment to its return value, negative offsets will remember
their position from the end of the string, affecting code like this:

=end original

C<substr> を呼び出した後、返り値が代入される前に、元の文字列の長さが
変更されると、負のオフセットは文字列の末尾からの位置を覚えているので、
以下のようなコードに影響を与えます:

    my $string = "string";
    my $lvalue = \substr $string, -4, 2;
    print $lvalue, "\n"; # prints "ri"
    $string = "bailing twine";
    print $lvalue, "\n"; # prints "wi"; used to print "il"

=begin original

The same thing happens with an omitted third argument.  The returned
lvalue will always extend to the end of the string, even if the string
becomes longer.

=end original

同じことは省略された 3 番目の引数でも起こります。
返された左辺値は、たとえ文字列が長くなっても、常に文字列の末尾に
拡張されます。

=begin original

Since this change also allowed many bugs to be fixed (see
L</The C<substr> operator>), and since the behaviour
of negative offsets has never been specified, so the
change was deemed acceptable.

=end original

この変更により多くのバグを修正できるようになり、
L</Fixes to the C<substr> operator> を参照してください)、
負数のオフセットの振る舞いは仕様になったことはないので、この変更は
受け入れられる取引でした。

=head3 Return value of C<tied>

(C<tied> の返り値)

=begin original

The value returned by C<tied> on a tied variable is now the actual
scalar that holds the object to which the variable is tied.  This
allows ties to be weakened with C<Scalar::Util::weaken(tied
$tied_variable)>.

=end original

tie された変数に対する C<tied> によって返される値は、変数が tie された
オブジェクトを保持する実際のスカラになりました。
これにより C<Scalar::Util::weaken(tied $tied_variable)> で tie を
弱めることが出来るようになります。

=head2 Unicode Support

(Unicode 対応)

=head3 Supports (I<almost>) Unicode 6.1

((I<ほぼ>) Unicode 6.1 対応)

=begin original

Besides the addition of whole new scripts, and new characters in
existing scripts, this new version of Unicode, as always, makes some
changes to existing characters.  One change that may trip up some
applications is that the General Category of two characters in the
Latin-1 range, PILCROW SIGN and SECTION SIGN, has been changed from
Other_Symbol to Other_Punctuation.  The same change has been made for
a character in each of Tibetan, Ethiopic, and Aegean.
The code points U+3248..U+324F (CIRCLED NUMBER TEN ON BLACK SQUARE
through CIRCLED NUMBER EIGHTY ON BLACK SQUARE) have had their General
Category changed from Other_Symbol to Other_Numeric.  The Line Break
property has changes for Hebrew and Japanese; and as a consequence of
other changes in 6.1, the Perl regular expression construct C<\X> now
works differently for some characters in Thai and Lao.

=end original

完全に新しい用字や、既にある用字への新しい文字の他に、新しい
Unicode はいつも通り、既にある文字もいくつか変更しています。
アプリケーションをつまずかせるかもしれない変更の一つは、
Latin-1 の範囲にある二つの文字 PILCROW SIGN および SECTION SIGN の
一般カテゴリは Other_Symbol から Other_Punctuation に変更されました。
同じ変更は Tibetan, Ethiopic, Aegean の文字に対しても行われました。
符号位置 U+3248..U+324F (CIRCLED NUMBER TEN ON BLACK SQUARE から
CIRCLED NUMBER EIGHTY ON BLACK SQUARE) の一般カテゴリは
Other_Symbol から Other_Numeric に変更されました。
Line Break 特性は Hebrew と Japanese で変更されました; そして 6.1 での
その他の変更の結果として、Perl の正規表現構造 C<\X> は Thai と Lao の
いくつかの文字では異なった動作をします。

=begin original

New aliases (synonyms) have been defined for many property values;
these, along with the previously existing ones, are all cross-indexed in
L<perluniprops>.

=end original

新しい別名が多くの特性値に定義されました; これらは、既に存在するものと
あわせて、全て L<perluniprops> にクロスインデックスされています。

=begin original

The return value of C<charnames::viacode()> is affected by other
changes:

=end original

C<charnames::viacode()> の帰り値はその他の変更の影響を受けます:

 Code point      Old Name             New Name
   U+000A    LINE FEED (LF)        LINE FEED
   U+000C    FORM FEED (FF)        FORM FEED
   U+000D    CARRIAGE RETURN (CR)  CARRIAGE RETURN
   U+0085    NEXT LINE (NEL)       NEXT LINE
   U+008E    SINGLE-SHIFT 2        SINGLE-SHIFT-2
   U+008F    SINGLE-SHIFT 3        SINGLE-SHIFT-3
   U+0091    PRIVATE USE 1         PRIVATE USE-1
   U+0092    PRIVATE USE 2         PRIVATE USE-2
   U+2118    SCRIPT CAPITAL P      WEIERSTRASS ELLIPTIC FUNCTION

=begin original

Perl will accept any of these names as input, but
C<charnames::viacode()> now returns the new name of each pair.  The
change for U+2118 is considered by Unicode to be a correction, that is
the original name was a mistake (but again, it will remain forever valid
to use it to refer to U+2118).  But most of these changes are the
fallout of the mistake Unicode 6.0 made in naming a character used in
Japanese cell phones to be "BELL", which conflicts with the longstanding
industry use of (and Unicode's recommendation to use) that name
to mean the ASCII control character at U+0007.  As a result, that name
has been deprecated in Perl since v5.14; and any use of it will raise a
warning message (unless turned off).  The name "ALERT" is now the
preferred name for this code point, with "BEL" being an acceptable short
form.  The name for the new cell phone character, at code point U+1F514,
remains undefined in this version of Perl (hence we don't quite
implement all of Unicode 6.1), but starting in v5.18, BELL will mean
this character, and not U+0007.

=end original

Perl は任意の名前を入力として受け付けますが、C<charnames::viacode()> は
それぞれのペアの新しい名前を返すようになりました。
U+2118 の変更は、元の名前が間違っていたための Unicode による訂正と
考えられます(しかし再び、これは U+2118 を参照するために永遠に有効の
ままです)。
しかしこれらの変更の中で最大のものは、日本の携帯電話で使われている
文字の名前に、長い間実用されている (そして Unicode も使用を推奨している
ASCII 制御文字 U+0007 と衝突している "BELL" という名前を付けたことによる
副産物です。
結果として、この名前は v5.14 以降 Perl では非推奨となっています;
そしてこれを使うと(オフにしていなければ)警告メッセージが発生します。
この符号位置に対する適切な名前は "ALERT" になり、短い形式として
"BEL" が受け入れられるようになります。
このバージョンの Perl では、符号位置 U+1F514 の新しい携帯電話の文字の
名前は未定義のままです(従って私たちは Unicode 6.1 の完全に全てを
実装しているわけではありません)が、v5.18 から BELL は U+0007 ではなく
この文字を意味するようになります。

=begin original

Unicode has taken steps to make sure that this sort of mistake does not
happen again.  The Standard now includes all the generally accepted
names and abbreviations for control characters, whereas previously it
didn't (though there were recommended names for most of them, which Perl
used).  This means that most of those recommended names are now
officially in the Standard.  Unicode did not recommend names for the
four code points listed above between U+008E and U+008F, and in
standardizing them Unicode subtly changed the names that Perl had
previously given them, by replacing the final blank in each name by a
hyphen.  Unicode also officially accepts names that Perl had deprecated,
such as FILE SEPARATOR.  Now the only deprecated name is BELL.
Finally, Perl now uses the new official names instead of the old
(now considered obsolete) names for the first four code points in the
list above (the ones which have the parentheses in them).

=end original

Unicode はこのような過ちが再び起きないようにするための対策を取りました。
今では標準には制御文字に対して、全ての一般的に受け入れられている名前を
含むようになりました(以前は含んでいませんでしたが、そのほとんどは
Perl が使っていた推奨される名前でした)。
Unicode は U+008E から U+008F の間の上述の四つの符号位置に対する
名前を推奨しておらず、and in
standardizing them Unicode subtly changed the names that Perl had
previously given them, by replacing the final blank in each name by a
hyphen.
Unicode はまた、FILE SEPARATOR のように Perl では非推奨とした名前を
公式に受け入れました。
今では唯一の非推奨の名前は BELL です。
最終的に、上述の四つの符号位置の名前として古い(今では古いものとなったと
考えられる)名前ではなく、新しい公式の名前(かっこで囲まれたもの)を使います。
(TBT)

=begin original

Now that the names have been placed in the Unicode standard, these kinds
of changes should not happen again, though corrections, such as to
U+2118, are still possible.

=end original

名前が Unicode 標準に入ったことにより、この種の変更は再び発生することは
ありませんが、U+2118 に対するような修正は引き続き起こりえます。

=begin original

Unicode also added some name abbreviations, which Perl now accepts:
SP for SPACE;
TAB for CHARACTER TABULATION;
NEW LINE, END OF LINE, NL, and EOL for LINE FEED;
LOCKING-SHIFT ONE for SHIFT OUT;
LOCKING-SHIFT ZERO for SHIFT IN;
and ZWNBSP for ZERO WIDTH NO-BREAK SPACE.

=end original

Unicode はまたいくつかの名前の略称を追加し、Perl でも使えるようになりました:
SPACE 用に SP;
CHARACTER TABULATION 用に TAB;
LINE FEED 用に NEW LINE, END OF LINE, NL, EOL;
SHIFT OUT 用に LOCKING-SHIFT ONE;
SHIFT IN 用に LOCKING-SHIFT ZERO;
ZERO WIDTH NO-BREAK SPACE 用に ZWNBSP。

=begin original

More details on this version of Unicode are provided in
L<http://www.unicode.org/versions/Unicode6.1.0/>.

=end original

このバージョンの Unicode に関するさらなる詳細は
L<http://www.unicode.org/versions/Unicode6.1.0/> で提供されています。

=head3 C<use charnames> is no longer needed for C<\N{I<name>}>

(C<\N{I<name>}> には C<use charnames> は不要に)

=begin original

When C<\N{I<name>}> is encountered, the C<charnames> module is now
automatically loaded when needed as if the C<:full> and C<:short>
options had been specified.  See L<charnames> for more information.

=end original

C<\N{I<name>}> に遭遇すると、必要なら C<:full> と C<:short> のオプションが
指定されたかのように C<charnames> モジュールが自動的に読み込まれるように
なりました。
さらなる情報については L<charnames> を参照してください。

=head3 C<\N{...}> can now have Unicode loose name matching

(C<\N{...}> は Unicode の緩い名前のマッチングに)

=begin original

This is described in the C<charnames> item in
L</Updated Modules and Pragmata> below.

=end original

これは後述する L</Updated Modules and Pragmata> の
C<charnames> に記述されています。

=head3 Unicode Symbol Names

(Unicode シンボル名)

=begin original

Perl now has proper support for Unicode in symbol names.  It used to be
that C<*{$foo}> would ignore the internal UTF8 flag and use the bytes of
the underlying representation to look up the symbol.  That meant that
C<*{"\x{100}"}> and C<*{"\xc4\x80"}> would return the same thing.  All
these parts of Perl have been fixed to account for Unicode:

=end original

Perl はシンボル名に対する Unicode 対応を適切に行うようになりました。
今までは C<*{$foo}> は内部 UTF8フラグを無視して、基となっているバイト列を
使います。

=over

=item *

=begin original

Method names (including those passed to C<use overload>)

=end original

メソッド名 (C<use overload> に渡されるものも含みます)

=item *

=begin original

Typeglob names (including names of variables, subroutines and filehandles)

=end original

型グロブ名 (変数、サブルーチン、ファイルハンドルの名前を含みます)

=item *

=begin original

Package names

=end original

パッケージ名

=item *

C<goto>

=item *

=begin original

Symbolic dereferencing

=end original

シンボリックなデリファレンス

=item *

=begin original

Second argument to C<bless()> and C<tie()>

=end original

C<bless()> と C<tie()> への第 2 引数

=item *

=begin original

Return value of C<ref()>

=end original

C<ref()> の返り値

=item *

=begin original

Subroutine prototypes

=end original

サブルーチンプロトタイプ

=item *

=begin original

Attributes

=end original

属性

=item *

=begin original

Various warnings and error messages that mention variable names or values,
methods, etc.

=end original

変数名や値、メソッドなどに言及する様々な警告やエラーメッセージ

=back

=begin original

In addition, a parsing bug has been fixed that prevented C<*{é}> from
implicitly quoting the name, but instead interpreted it as C<*{+é}>, which
would cause a strict violation.

=end original

さらに、C<*{é}> を暗黙にクォートする名前から除外するバグが修正され、
strict 違反となる C<*{+é}> として解釈されるようになりました。

=begin original

C<*{"*a::b"}> automatically strips off the * if it is followed by an ASCII
letter.  That has been extended to all Unicode identifier characters.

=end original

C<*{"*a::b"}> は、* の後に ASCII 文字が引き続いている場合は * が自動的に
削除されます。
これは全ての Unicode 識別子文字に拡張されました。

=begin original

One-character non-ASCII non-punctuation variables (like C<$é>) are now
subject to "Used only once" warnings.  They used to be exempt, as they
was treated as punctuation variables.

=end original

(C<$é> のような) 単一文字非 ASCII 非句読点変数はは
"Used only once" 警告を出すようになりました。
今までは、これは句読点変数として扱われていたので警告から免れていました。

=begin original

Also, single-character Unicode punctuation variables (like $‰) are now
supported [perl #69032].

=end original

また、($‰ のような)単一文字の Unicode 句読点変数に対応しました
[perl #69032]。

=head3 Improved ability to mix locales and Unicode, including UTF-8 locales

((UTF-8 ロケールを含む)ロケールと Unicode を混ぜる能力の改善)

=begin original

An optional parameter has been added to C<use locale>

=end original

C<use locale> にオプションの引数が追加されました:

 use locale ':not_characters';

=begin original

which tells Perl to use all but the C<LC_CTYPE> and C<LC_COLLATE>
portions of the current locale.  Instead, the character set is assumed
to be Unicode.  This allows locales and Unicode to be seamlessly mixed,
including the increasingly frequent UTF-8 locales.  When using this
hybrid form of locales, the C<:locale> layer to the L<open> pragma can
be used to interface with the file system, and there are CPAN modules
available for ARGV and environment variable conversions.

=end original

は、現在のロケールのうち、C<LC_CTYPE> と C<LC_COLLATE> 以外の全てを
使うことを Perl に知らせます。
それ以外では、文字集合は Unicode であると仮定します。
これにより、徐々に頻繁に出てくる UTF-8 ロケールを含む、ロケールと
Unicode をシームレスに混ぜることが出来るようになります。
このハイブリッド形式のロケールを使うとき、
L<open> への C<:locale> 層をファイルシステムへのインターフェースとして
使うことができ、ARGV と環境変数の変換のための CPAN モジュールを
利用可能です。

=begin original

Full details are in L<perllocale>.

=end original

完全な詳細は L<perllocale> にあります。

=head3 New function C<fc> and corresponding escape sequence C<\F> for Unicode foldcase

(Unicode 畳み込み文字のための新しい関数 C<fc> と対応するエスケープシーケンス C<\F>)

=begin original

Unicode foldcase is an extension to lowercase that gives better results
when comparing two strings case-insensitively.  It has long been used
internally in regular expression C</i> matching.  Now it is available
explicitly through the new C<fc> function call (enabled by
S<C<"use feature 'fc'">>, or C<use v5.16>, or explicitly callable via
C<CORE::fc>) or through the new C<\F> sequence in double-quotish
strings.

=end original

Unicode の畳み込み文字は、二つの文字列を大文字小文字を無視して比較するときに
よりよい結果を与えるための小文字の拡張です。
これは長い間正規表現の C</i> マッチングで内部で使われていました。
これは (S<C<"use feature 'fc'">>、C<use v5.16> で有効にするか、
明示的な C<CORE::fc> で明示的に呼び出し可能な)新しい C<fc> 関数呼び出しか、
ダブルクォート風の文字列の中の新しい C<\F> シーケンスを通して
利用可能になりました。

=begin original

Full details are in L<perlfunc/fc>.

=end original

完全な詳細は L<perlfunc/fc> にあります。

=head3 The Unicode C<Script_Extensions> property is now supported.

(Unicode の C<Script_Extensions> 特性に対応)

=begin original

New in Unicode 6.0, this is an improved C<Script> property.  Details
are in L<perlunicode/Scripts>.

=end original

Unicode 6.0 からの新機能で、これは改良された C<Script> 特性です。
詳細は L<perlunicode/Scripts> にあります。

=head2 XS Changes

=head3 Improved typemaps for Some Builtin Types

(いくつかの組み込み型の typemap の改善)

=begin original

Most XS authors will be aware that there is a longstanding bug in the
OUTPUT typemap for T_AVREF (C<AV*>), T_HVREF (C<HV*>), T_CVREF (C<CV*>),
and T_SVREF (C<SVREF> or C<\$foo>) that requires manually decrementing
the reference count of the return value instead of the typemap taking
care of this.  For backwards-compatibility, this cannot be changed in the
default typemaps.  But we now provide additional typemaps
C<T_AVREF_REFCOUNT_FIXED>, etc. that do not exhibit this bug.  Using
them in your extension is as simple as having one line in your
C<TYPEMAP> section:

=end original

ほとんどの XS 作者は、will be aware that there is a longstanding bug in the
OUTPUT typemap for T_AVREF (C<AV*>), T_HVREF (C<HV*>), T_CVREF (C<CV*>),
and T_SVREF (C<SVREF> or C<\$foo>) that requires manually decrementing
the reference count of the return value instead of the typemap taking
care of this.
後方互換性のために、これはデフォルトの typemap では変更できません。
しかし、この問題が含まれない
C<T_AVREF_REFCOUNT_FIXED> などの追加の typemap を提供することになりました。
エクステンションでこれらを使うことで、
C<TYPEMAP> セクションを 1 行にまで単純化できます:
(TBT)

  HV*	T_HVREF_REFCOUNT_FIXED

=head3 C<is_utf8_char()>

=begin original

The XS-callable function C<is_utf8_char()>, when presented with
malformed UTF-8 input, can read up to 12 bytes beyond the end of the
string.  This cannot be fixed without changing its API.  It is not
called from CPAN.  The documentation now describes how to use it
safely.

=end original

XS 呼び出し可能な関数 C<is_utf8_char()> は、不正な UTF-8 入力があると、
文字列の終わりを越えて最大 12 バイト読む可能性があります。
これは API を変更せずに修正することはできません。
これは CPAN からは呼び出されません。
文書にはこれを安全に使う方法を記述しています。

=head3 Added C<is_utf8_char_buf()>

(C<is_utf8_char_buf()> の追加)

=begin original

This function is designed to replace the deprecated L</is_utf8_char()>
function.  It includes an extra parameter to make sure it doesn't read
past the end of the input buffer.

=end original

この関数は非推奨の L</is_utf8_char()> 関数を置き換えるために
設計されています。
これには入力バッファの末尾を越えて読み込まないようにするための追加の引数が
あります。

=head3 Other C<is_utf8_foo()> functions, as well as C<utf8_to_foo()>, etc.

(C<utf8_to_foo()> のような、その他の C<is_utf8_foo()> 関数)

=begin original

Most of the other XS-callable functions that take UTF-8 encoded input
implicitly assume that the UTF-8 is valid (not malformed) in regards to
buffer length.  Do not do things such as change a character's case or
see if it is alphanumeric without first being sure that it is valid
UTF-8.  This can be safely done for a whole string by using one of the
functions C<is_utf8_string()>, C<is_utf8_string_loc()>, and
C<is_utf8_string_loclen()>.

=end original

UTF-8 エンコードされた入力を取るその他の XS 呼び出し可能な関数のほとんどは
バッファ長に関して UTF-8 が有効である(不正でない)ことを暗黙に
仮定しています。
まず文字列が有効な UTF-8 であることを確認せずに、文字の大文字小文字を
変更したり、英数字かどうかを確認したりしてはいけません。 
このようなことは、文字列全体に対して C<is_utf8_string()>,
C<is_utf8_string_loc()>, C<is_utf8_string_loclen()> のいずれかを使うことで
安全に行えます。

=head3 New Pad API

(新しいパッド API)

=begin original

Many new functions have been added to the API for manipulating lexical
pads.  See L<perlapi/Pad Data Structures> for more information.

=end original

レキシカルパッドを操作するための多くの新しい関数が API に追加されました。
さらなる情報については L<perlapi/Pad Data Structures> を参照してください。

=head2 Changes to Special Variables

(特殊変数に関する変更)

=head3 C<$$> can be assigned to

(C<$$> は代入可能に)

=begin original

C<$$> was made read-only in Perl 5.8.0.  But only sometimes: C<local $$>
would make it writable again.  Some CPAN modules were using C<local $$> or
XS code to bypass the read-only check, so there is no reason to keep C<$$>
read-only.  (This change also allowed a bug to be fixed while maintaining
backward compatibility.)

=end original

C<$$> は Perl 5.8.0 で読み込みせんようになりました。
しかしときどき: C<local $$> で再び書き込み可能になることがあります。
CPAN モジュールによっては読み込み専用のチェックを回避するために
C<local $$> や XS コードを使っているものもあるので、C<$$> よ読み込み専用に
保っておく理由がありません。
(この変更はまた、過去互換性を維持する間に修正するべきバグを許します。)

=head3 C<$^X> converted to an absolute path on FreeBSD, OS X and Solaris

(FreeBSD, OS X, Solaris でも C<$^X> が絶対パスに変換されるように)

=begin original

C<$^X> is now converted to an absolute path on OS X, FreeBSD (without
needing F</proc> mounted) and Solaris 10 and 11.  This augments the
previous approach of using F</proc> on Linux, FreeBSD and NetBSD
(in all cases, where mounted).

=end original

C<$^X> は、OS X、(F</proc> をマウントする必要のない) FreeBSD、
Solaris 10 と 11 では絶対パスに変換されるようになりました。
これは Linux, FreeBSD, NetBSD で(マウントされているときに)
F</proc> を使うという以前の手法を拡大します。

=begin original

This makes relocatable perl installations more useful on these platforms.
(See "Relocatable @INC" in F<INSTALL>)

=end original

これにより、これらのプラットフォームでの再配置可能な perl インストールが
より便利になります。
(F<INSTALL> の "Relocatable @INC" を参照してください。)

=head2 Debugger Changes

(デバッガの変更)

=head3 Features inside the debugger

(デバッガ内部の機能)

=begin original

The current Perl's L<feature> bundle is now enabled for commands entered
in the interactive debugger.

=end original

現在の Perl の L<feature> バンドルは、対話的デバッガで入力されたコマンドで
有効になるようになりました。

=head3 New option for the debugger's B<t> command

(デバッガの B<t> コマンドの新しいオプション)

=begin original

The B<t> command in the debugger, which toggles tracing mode, now
accepts a numeric argument that determines how many levels of subroutine
calls to trace.

=end original

トレースモードをトグルするデバッガの B<t> コマンドは、サブルーチン
呼び出しを何レベルまでトレースするかを決定する数値引数を
受け付けるようになりました。

=head3 C<enable> and C<disable>

(C<enable> と C<disable>)

=begin original

The debugger now has C<disable> and C<enable> commands for disabling
existing breakpoints and re-enabling them.  See L<perldebug>.

=end original

デバッガに、すでに有るブレークポイントを無効にしたり、再び有効に
したりするためのC<disable> コマンドと C<enable> コマンドが追加されました。
L<perldebug> を参照してください。

=head3 Breakpoints with file names

(ファイル名付きのブレークポイント)

=begin original

The debugger's "b" command for setting breakpoints now allows a line
number to be prefixed with a file name.  See
L<perldebug/"b [file]:[line] [condition]">.

=end original

ブレークポイントを設定するためのデバッガの "b" コマンドは、ファイル名の
後ろに付ける行番号を受け付けるようになりました。
L<perldebug/"b [file]:[line] [condition]"> を参照してください。

=head2 The C<CORE> Namespace

(C<CORE> 名前空間)

=head3 The C<CORE::> prefix

(C<CORE::> 前置詞)

=begin original

The C<CORE::> prefix can now be used on keywords enabled by
L<feature.pm|feature>, even outside the scope of C<use feature>.

=end original

C<CORE::> 前置詞は、たとえ C<use feature> スコープの外側でも、
L<feature.pm|feature> で有効になるキーワードで使われるようになりました。

=head3 Subroutines in the C<CORE> namespace

(C<CORE> 名前空間のサブルーチン)

=begin original

Many Perl keywords are now available as subroutines in the CORE namespace.
This allows them to be aliased:

=end original

多くの Perl キーワードが CORE 名前空間で利用可能になりました。
これにより以下のように別名にできるようになります:

    BEGIN { *entangle = \&CORE::tie }
    entangle $variable, $package, @args;

=begin original

And for prototypes to be bypassed:

=end original

そしてプロトタイプを回避するには:

    sub mytie(\[%$*@]$@) {
	my ($ref, $pack, @args) = @_;
	... do something ...
	goto &CORE::tie;
    }

=begin original

Some of these cannot be called through references or via C<&foo> syntax,
but must be called as barewords.

=end original

これらの一部はリファレンスや C<&foo> 文法では呼び出すことができず、
裸の単語で呼び出さなければなりません。

=begin original

See L<CORE> for details.

=end original

詳しくは L<CORE> を参照してください。

=head2 Other Changes

(その他の変更)

=head3 Anonymous handles

(無名ハンドル)

=begin original

Automatically generated file handles are now named __ANONIO__ when the
variable name cannot be determined, rather than $__ANONIO__.

=end original

変数名が決定できないときに自動的に生成されるファイルハンドルの名前は
$__ANONIO__ ではなく __ANONIO__ になりました。

=head3 Autoloaded sort Subroutines

(ソートサブルーチンがオートロードされるように)

=begin original

Custom sort subroutines can now be autoloaded [perl #30661]:

=end original

カスタムソートサブルーチンはオートロードされるようになりました
[perl #30661]:

    sub AUTOLOAD { ... }
    @sorted = sort foo @list; # uses AUTOLOAD

=head3 C<continue> no longer requires the "switch" feature

(C<continue> には "switch" は不要に)

=begin original

The C<continue> keyword has two meanings.  It can introduce a C<continue>
block after a loop, or it can exit the current C<when> block.  Up till now,
the latter meaning was only valid with the "switch" feature enabled, and
was a syntax error otherwise.  Since the main purpose of feature.pm is to
avoid conflicts with user-defined subroutines, there is no reason for
C<continue> to depend on it.

=end original

C<continue> キーワードには二つの意味があります。
ループの後に C<continue> ブロックを導入する意味と、現在の C<when> ブロックを
出る意味です。
今まで、後者の意味は "switch" 機能が有効の場合にのみ正当で、さもなければ
文法エラーでした。
feature.pm の主な目的はユーザー定義サブルーチンとの衝突を避けることなので、
C<continue> がこれに依存している意味はありません。

=head3 DTrace probes for interpreter phase change

(インタプリタフェーズ変更のための DTrace プローブ)

=begin original

The C<phase-change> probes will fire when the interpreter's phase
changes, which tracks the C<${^GLOBAL_PHASE}> variable.  C<arg0> is
the new phase name; C<arg1> is the old one.  This is useful mostly
for limiting your instrumentation to one or more of: compile time,
run time, destruct time.

=end original

C<phase-change> プローブは、C<${^GLOBAL_PHASE}> 変数を
追跡することによって、インタプリタのフェーズが変わったときに起動されます。
C<arg0> は新しいフェーズ名です; C<arg1> は古いフェーズ名です。
これはコンパイル時、実行時、破壊時に装備を制限するために普通は有用です。

=head3 C<__FILE__()> Syntax

(C<__FILE__()> 文法)

=begin original

The C<__FILE__>, C<__LINE__> and C<__PACKAGE__> tokens can now be written
with an empty pair of parentheses after them.  This makes them parse the
same way as C<time>, C<fork> and other built-in functions.

=end original

C<__FILE__>, C<__LINE__>, C<__PACKAGE__> トークンは、後ろに空のかっこの
組を書けるようになりました。
これにより C<time>, C<fork> やその他の組み込み関数と同じ方法で
パースできるようになります。

=head3 The C<\$> prototype accepts any scalar lvalue

=begin original

The C<\$> and C<\[$]> subroutine prototypes now accept any scalar lvalue
argument.  Previously they only accepted scalars beginning with C<$> and
hash and array elements.  This change makes them consistent with the way
the built-in C<read> and C<recv> functions (among others) parse their
arguments.  This means that one can override the built-in functions with
custom subroutines that parse their arguments the same way.

=end original

C<\$> と C<\[$]> のサブルーチンプロトタイプは任意のスカラ左辺値引数を
受け付けるようになりました。
以前は C<$> で始まるスカラとハッシュおよび配列の要素のみを
受け付けていました。
This change makes them consistent with the way
the built-in C<read> and C<recv> functions (among others) parse their
arguments.
これは、同じ方法で引数をパースするカスタムサブルーチンで組み込み関数を
オーバーライドできることを意味します。
(TBT)

=head3 C<_> in subroutine prototypes

(サブルーチンプロトタイプの C<_>)

=begin original

The C<_> character in subroutine prototypes is now allowed before C<@> or
C<%>.

=end original

サブルーチンプロトタイプの C<_> 文字は C<@> や C<%> の前に
使えるようになりました。

=head1 Security

(セキュリティ)

=head2 Use C<is_utf8_char_buf()> and not C<is_utf8_char()>

(C<is_utf8_char()> ではなく C<is_utf8_char_buf()> を使う)

=begin original

The latter function is now deprecated because its API is insufficient to
guarantee that it doesn't read (up to 12 bytes in the worst case) beyond
the end of its input string.  See
L<is_utf8_char_buf()|/Added is_utf8_char_buf()>.

=end original

後者の関数は、API が入力文字列の末尾を超えて(最悪の場合最大 12 バイト)
読み込まないことを保証できないので非推奨になりました。
L<is_utf8_char_buf()|/Added is_utf8_char_buf()> を参照してください。

=head2 C<File::Glob::bsd_glob()> memory error with GLOB_ALTDIRFUNC (CVE-2011-2728).

(GLOB_ALTDIRFUNC での C<File::Glob::bsd_glob()> のメモリエラー (CVE-2011-2728))

=begin original

Calling C<File::Glob::bsd_glob> with the unsupported flag
GLOB_ALTDIRFUNC would cause an access violation / segfault.  A Perl
program that accepts a flags value from an external source could expose
itself to denial of service or arbitrary code execution attacks.  There
are no known exploits in the wild.  The problem has been corrected by
explicitly disabling all unsupported flags and setting unused function
pointers to null.  Bug reported by Clément Lecigne.

=end original

未対応フラグ GLOB_ALTDIRFUNC 付きで C<File::Glob::bsd_glob> を呼び出すと
アクセス違反/セグメンテーションフォルトを引き起こすことがありました。
外部ソースからフラグの値を受け付ける Perl プログラムはサービス不能攻撃や
任意コード実行攻撃に晒されるかもしれません。
今のところ知られている攻撃はありません。
この問題は、未対応フラグを明示的に無効にして、未使用関数のポインタを
null にすることで修正されました。
バグは ClE<eacute>ment Lecigne によって報告されました。

=head2 Privileges are now set correctly when assigning to C<$(>

(C<$(> への代入時に権限が適切に設定されるように)

=begin original

A hypothetical bug (probably non-exploitable in practice) due to the
incorrect setting of the effective group ID while setting C<$(> has been
fixed.  The bug would only have affected systems that have C<setresgid()>
but not C<setregid()>, but no such systems are known of.

=end original

C<$(> の設定中の有効グループ ID の設定が正しくないことによる仮説上の
(おそらく実際には攻撃できない)バグが修正されました。
このバグは C<setresgid()> はあるけれども C<setregid()> がないシステムにのみ
影響を与えますが、そのようなシステムは知られていません。

=head1 Deprecations

(非推奨)

=head2 Don't read the Unicode data base files in F<lib/unicore>

(F<lib/unicore> にある Unicode データベースファイルは読み込まない)

=begin original

It is now deprecated to directly read the Unicode data base files.
These are stored in the F<lib/unicore> directory.  Instead, you should
use the new functions in L<Unicode::UCD>.  These provide a stable API,
and give complete information.

=end original

Unicode データベースファイルを直接読むのは非推奨になりました。
これらは F<lib/unicore> ディレクトリに補完されています。
代わりに、L<Unicode::UCD> の新しい関数を使うべきです。
これらは安定した API を提供し、完全な情報を得られます。

=begin original

Perl may at some point in the future change or remove the files.  The
file most likely for applications to have used is
F<lib/unicore/ToDigit.pl>.  L<Unicode::UCD/prop_invmap()> can be used to
get at its data instead.

=end original

Perl は将来のいずれかの時点でファイルを変更または削除するかもしれません。
アプリケーションから一番使われていたであろうファイルは
F<lib/unicore/ToDigit.pl> です。
代わりにこのデータを得るために L<Unicode::UCD/prop_invmap()> が使えます。

=head2 C<is_utf8_char()>

=begin original

This function is deprecated because it could read beyond the end of the
input string.  Use the new L<is_utf8_char_buf()|/Added is_utf8_char_buf()>
instead.

=end original

この関数は、入力文字列の末尾を超えて読み込むかもしれないので、
非推奨になりました。
代わりに新しい L<is_utf8_char_buf()|/Added is_utf8_char_buf()> を
使ってください。

=head1 Future Deprecations

(将来の非推奨)

=begin original

This section serves as a notice of features that are I<likely> to be
removed or L<deprecated|perlpolicy/deprecated> in the next release of
perl (5.18.0).  If your code depends on these features, you should
contact the Perl 5 Porters via the L<mailing
list|http://lists.perl.org/list/perl5-porters.html> or L<perlbug> to
explain your use case and inform the deprecation process.

=end original

この章は、次のリリースの perl (5.18.0) で I<おそらく> 削除されるか
L<非推奨|perlpolicy/deprecated> になる機能を示します。
あなたのコードがこれらの機能に依存しているなら、あなたのユースケースを
説明して非推奨プロセスに知らせるために、
L<メーリングリスト|http://lists.perl.org/list/perl5-porters.html> か
L<perlbug> で Perl 5 Porters に知らせるべきです。

=head2 Core Modules

(コアモジュール)

=begin original

These modules may be marked as deprecated I<from the core>.  This only
means that they will no longer be installed by default with the core
distribution, but will remain available on the CPAN.

=end original

これらのモジュールは I<コアからは> 非推奨としてマークされました。
これはコア配布でデフォルトではインストールされなくなるというだけで、
CPAN からは利用可能のままです。

=over

=item *

CPANPLUS

=item *

Filter::Simple

=item *

PerlIO::mmap

=item *

Pod::Parser, Pod::LaTeX

=item *

SelfLoader

=item *

Text::Soundex

=item *

Thread.pm

=back

=head2 Platforms with no supporting programmers:

(サポートするプログラマがいないプラットフォーム)

=begin original

These platforms will probably have their
special build support removed during the
5.17.0 development series.

=end original

以下のプラットフォームはおそらく 5.17.0 開発シリーズの間に独自のビルド
サポートが削除されます。

=over

=item *

BeOS

=item *

djgpp

=item *

dgux

=item *

EPOC

=item *

MPE/iX

=item *

Rhapsody

=item *

UTS

=item *

VM/ESA

=back

=head2 Other Future Deprecations

(その他の将来の非推奨)

=over

=item *

=begin original

Swapping of $< and $>

=end original

$< と $> の交換

=begin original

For more information about this future deprecation, see L<the relevant RT
ticket|https://rt.perl.org/rt3/Ticket/Display.html?id=96212>.

=end original

この将来の非推奨に関するさらなる情報については、
L<関連する RT チケット|https://rt.perl.org/rt3/Ticket/Display.html?id=96212> を
参照してください。

=item *

sfio, stdio

=item *

=begin original

Unescaped literal C<< "{" >> in regular expressions.

=end original

正規表現中のエスケープされていないリテラルの C<< "{" >>。

=begin original

It is planned starting in v5.20 to require a literal C<"{"> to be
escaped by, for example, preceding it with a backslash.  In v5.18, a
deprecated warning message will be emitted for all such uses.  Note that
this only affects patterns which are to match a literal C<"{">.  Other
uses of this character, such as part of a quantifier or sequence like in
the ones below are completely unaffected:

=end original

v5.20 から、リテラルの C<"{"> は、例えばバックスラッシュを前置することで、
エスケープする必要があるようにすることが計画されています。
v5.18 では、このような使用全てで警告が出力されます。
これはリテラルな C<"{"> にマッチングするパターンにのみ影響を与えることに
注意してください。
量指定子の一部や、以下のシーケンスのような、その他のこの文字の使用には
全く影響を与えません:

    /foo{3,5}/
    /\p{Alphabetic}/
    /\N{DIGIT ZERO}

=begin original

The removal of this will allow extensions to pattern syntax, and better
error checking of existing syntax.  See L<perlre/Quantifiers> for an
example.

=end original

この除去によって、パターン文法の拡張や、既にある文法のよりよいエラーチェックが
可能になります。
例については L<perlre/Quantifiers> を参照してください。

=back

=head1 Incompatible Changes

(互換性のない変更)

=head2 Special blocks called in void context

(特殊ブロックは無効コンテキストで呼び出されるように)

=begin original

Special blocks (C<BEGIN>, C<CHECK>, C<INIT>, C<UNITCHECK>, C<END>) are now
called in void context.  This avoids wasteful copying of the result of the
last statement [perl #108794].

=end original

特殊ブロック (C<BEGIN>, C<CHECK>, C<INIT>, C<UNITCHECK>, C<END>) は
無効コンテキストで呼び出されるようになりました。。
これにより、最後の行の結果を無駄にコピーすることを防げます [perl #108794]。

=head2 The C<overloading> pragma and regexp objects

(C<overloading> プラグマと正規表現オブジェクト)

=begin original

With C<no overloading>, regular expression objects returned by C<qr//> are
now stringified as "Regexp=REGEXP(0xbe600d)" instead of the regular
expression itself [perl #108780].

=end original

C<no overloading> のとき、 C<qr//> によって返される正規表現オブジェクトは
正規表現自体ではなく、"Regexp=REGEXP(0xbe600d)" として
文字列化されるようになりました。

=head2 Two XS typemap Entries removed

(二つの XS typemap エントリを削除)

=begin original

Two presumably unused XS typemap entries have been removed from the
core typemap: T_DATAUNIT and T_CALLBACK.  If you are, against all odds,
a user of these, please see the instructions on how to regain them
in L<perlxstypemap>.

=end original

おそらく使われていない二つの XS typemap エントリ(T_DATAUNIT と T_CALLBACK)が
コア typemap から削除されました。
もしあなたが、あらゆる予想を覆して、これらを使っているなら、
これらを復活させる方法を記してある L<perlxstypemap> を参照してください。

=head2 Unicode 6.1 has incompatibilities with Unicode 6.0

(Unicode 6.1 は Unicode 6.0 と互換性がない)

=begin original

These are detailed in L</Supports (almost) Unicode 6.1> above.
You can compile this version of Perl to use Unicode 6.0.  See
L<perlunicode/Hacking Perl to work on earlier Unicode versions (for very serious hackers only)>.

=end original

この詳細は上述の L</Supports (almost) Unicode 6.1> にあります。
このバージョンの Perl を Unicode 6.0 を使ってコンパイルすることも出来ます。
L<perlunicode/Hacking Perl to work on earlier Unicode versions (for very serious hackers only)> を
参照してください。

=head2 Borland compiler

(Borland コンパイラ)

=begin original

All support for the Borland compiler has been dropped.  The code had not
worked for a long time anyway.

=end original

Borland コンパイラ対応が全て削除されました。
どちらにしろコードは長い間動作していませんでした。

=head2 Certain deprecated Unicode properties are no longer supported by default

(いくつかの非推奨の Unicode 特性がデフォルトではサポート外に)

=begin original

Perl should never have exposed certain Unicode properties that are used
by Unicode internally and not meant to be publicly available.  Use of
these has generated deprecated warning messages since Perl 5.12.  The
removed properties are Other_Alphabetic,
Other_Default_Ignorable_Code_Point, Other_Grapheme_Extend,
Other_ID_Continue, Other_ID_Start, Other_Lowercase, Other_Math, and
Other_Uppercase.

=end original

Perl は、Unicode が内部で使って公開するつもりがないいくつかの Unicode 特性を
暴露するべきではありません。
Perl 5.12 以降これらを使うと警告が出力されていました。
削除された特性は、Other_Alphabetic,
Other_Default_Ignorable_Code_Point, Other_Grapheme_Extend,
Other_ID_Continue, Other_ID_Start, Other_Lowercase, Other_Math, 
Other_Uppercase です。

=begin original

Perl may be recompiled to include any or all of them; instructions are
given in
L<perluniprops/Unicode character properties that are NOT accepted by Perl>.

=end original

これらの一部または全部を含む形で Perl を再コンパイルすることもできます;
手順は
L<perluniprops/Unicode character properties that are NOT accepted by Perl> に
あります。

=head2 Dereferencing IO thingies as typeglobs

(IO 系のものを型グロブとしてデリファレンス)

=begin original

The C<*{...}> operator, when passed a reference to an IO thingy (as in
C<*{*STDIN{IO}}>), creates a new typeglob containing just that IO object.
Previously, it would stringify as an empty string, but some operators would
treat it as undefined, producing an "uninitialized" warning.
Now it stringifies as __ANONIO__ [perl #96326].

=end original

C<*{...}> 演算子は、(C<*{*STDIN{IO}}> のような) IO 系へのリファレンスを
渡すと、IO オブジェクト自体を含む新しい型グロブを作成します。
以前は、空文字列として文字列化していましたが、一部の演算子はこれを
未定義として扱い、"uninitialized" 警告を出力していました。
今では __ANONIO__ と文字列化されます [perl #96326]。

=head2 User-defined case changing operations.

(ユーザー定義大文字変更操作)

=begin original

This feature was deprecated in Perl 5.14, and has now been removed.
The CPAN module L<Unicode::Casing> provides better functionality without
the drawbacks that this feature had, as are detailed in the 5.14
documentation:
L<http://perldoc.perl.org/5.14.0/perlunicode.html#User-Defined-Case-Mappings-%28for-serious-hackers-only%29>

=end original

この機能は Perl 5.14 で非推奨となり、今回削除されました。
CPAN モジュール L<Unicode::Casing> は、5.14 の文書に詳細に記されている通り、
この機能が持っていた欠点なしに、よりよい機能を提供します:
L<http://perldoc.perl.org/5.14.0/perlunicode.html#User-Defined-Case-Mappings-%28for-serious-hackers-only%29>

=head2 XSUBs are now 'static'

(XSUB は 'static' に)

=begin original

XSUB C functions are now 'static', that is, they are not visible from
outside the compilation unit.  Users can use the new C<XS_EXTERNAL(name)>
and C<XS_INTERNAL(name)> macros to pick the desired linking behaviour.
The ordinary C<XS(name)> declaration for XSUBs will continue to declare
non-'static' XSUBs for compatibility, but the XS compiler,
C<ExtUtils::ParseXS> (C<xsubpp>) will emit 'static' XSUBs by default.
C<ExtUtils::ParseXS>'s behaviour can be reconfigured from XS using the
C<EXPORT_XSUB_SYMBOLS> keyword.  See L<perlxs> for details.

=end original

XSUB C 関数は 'static' になりました; つまり、コンパイル単位の外側からは
見えなくなりました。
ユーザーは求めるリンクの振る舞いを得るために新しい
C<XS_EXTERNAL(name)> マクロと C<XS_INTERNAL(name)> マクロを使えます。
XSUB の通常の C<XS(name)> 宣言は互換性のために非 'static' な XSUB を
宣言するままですが、XS コンパイラ C<ExtUtils::ParseXS> (C<xsubpp>) は
デフォルトでは 'static' XSUB を出力します。
C<ExtUtils::ParseXS> の振る舞いは C<EXPORT_XSUB_SYMBOLS> キーワードを
使った XS によって再設定できます。
詳しくは L<perlxs> を参照してください。

=head2 Weakening read-only references

(読み込み専用の参照を弱くする)

=begin original

Weakening read-only references is no longer permitted.  It should never
have worked anyway, and in some cases could result in crashes.

=end original

読み込み専用の参照を弱くすることはできなくなりました。
どちらにしても正しく動作しておらず、場合によってはクラッシュしていました。

=head2 Tying scalars that hold typeglobs

(型グロブを保持しているスカラの tie)

=begin original

Attempting to tie a scalar after a typeglob was assigned to it would
instead tie the handle in the typeglob's IO slot.  This meant that it was
impossible to tie the scalar itself.  Similar problems affected C<tied> and
C<untie>: C<tied $scalar> would return false on a tied scalar if the last
thing returned was a typeglob, and C<untie $scalar> on such a tied scalar
would do nothing.

=end original

型グロブを代入された後のスカラを tie しようとすると、代わりに型グロブの
IO スロットにあるハンドルが tie されます。
これは、スカラ自身を tie することが不可能になると言うことを意味します。
似たような問題は C<tied> と C<untie> に影響を与えます: C<tied $scalar> は
最後に返されたものが型グロブの場合は tie されたスカラに偽を返し、
そのような tie されたスカラに C<untie $scalar> しても何も起きません。

=begin original

We fixed this problem before Perl 5.14.0, but it caused problems with some
CPAN modules, so we put in a deprecation cycle instead.

=end original

私たちはこの問題を Perl 5.14.0 の前に修正しましたが、これは一部の
CPAN モジュールに問題を引き起こすので、代わりに
非推奨サイクルに入れることにしました。

=begin original

Now the deprecation has been removed and this bug has been fixed.  So
C<tie $scalar> will always tie the scalar, not the handle it holds.  To tie
the handle, use C<tie *$scalar> (with an explicit asterisk).  The same
applies to C<tied *$scalar> and C<untie *$scalar>.

=end original

今回非推奨は削除され、バグは修正されました。
それで C<tie $scalar> は、スカラが保存しているハンドルではなく、スカラ自身を
tie します。
ハンドルを tie するには、C<tie *$scalar> を(明示的なアスタリスク付きで)
使ってください。
同じ内容は C<tied *$scalar> と C<untie *$scalar> にも適用されます。

=head2 IPC::Open3 no longer provides C<xfork()>, C<xclose_on_exec()>
and C<xpipe_anon()>

(IPC::Open3 は C<xfork()>, C<xclose_on_exec()>, C<xpipe_anon()> を提供しません)

=begin original

All three functions were private, undocumented and unexported.  They do
not appear to be used by any code on CPAN.  Two have been inlined and one
deleted entirely.

=end original

これら三つの関数はプライベートなもので文書化されておらずエクスポートも
されていません。
これらは CPAN のどのコードからも使われていません。
二つはインライン化され、一つは完全に削除されました。

=head2 C<$$> no longer caches PID

(C<$$> は PID をキャッシュしません)

=begin original

Previously, if one called fork(3) from C, Perl's
notion of C<$$> could go out of sync with what getpid() returns.  By always
fetching the value of C<$$> via getpid(), this potential bug is eliminated.
Code that depends on the caching behavior will break.  As described in
L<Core Enhancements|/C<$$> can be assigned to>,
C<$$> is now writable, but it will be reset during a
fork.

=end original

以前は、C から fork(3) を呼び出すと、Perl の C<$$> の概念は getpid() が
返すものと同期しなくなることがありました。
常に getpid() 経由で C<$$> の値を取得することで、この潜在的なバグは
修正されました。
キャッシュする振る舞いに依存しているコードは動かなくなります。
L<Core Enhancements|/C<$$> can be assigned to> で記述したように、
C<$$> は書き込み可能になりましたが、fork 中はリセットされます。

=head2 C<$$> and C<getppid()> no longer emulate POSIX semantics under LinuxThreads

(C<$$> と C<getppid()> は LinuxThreads のもとで POSIX の意味論をエミュレートしません)

=begin original

The POSIX emulation of C<$$> and C<getppid()> under the obsolete
LinuxThreads implementation has been removed.
This only impacts users of Linux 2.4 and
users of Debian GNU/kFreeBSD up to and including 6.0, not the vast
majority of Linux installations that use NPTL threads.

=end original

古い LinuxThreads 実装のもとでの C<$$> と C<getppid()> の POSIX
エミュレーションは削除されました。
これは Linux 2.4 のユーザーとバージョン 6.0 までの Debian GNU/kFreeBSD の
ユーザーにのみ影響があり、NPTL スレッドを使っている圧倒的多数の
Linux インストールには影響はありません。

=begin original

This means that C<getppid()>, like C<$$>, is now always guaranteed to
return the OS's idea of the current state of the process, not perl's
cached version of it.

=end original

これは、C<getppid()> は C<$$> と同様に、perl がキャッシュしたものではなく
OS が考えているプロセスの現在の状態を常に返すと言うことを意味まします。

=begin original

See the documentation for L<$$|perlvar/$$> for details.

=end original

詳しくは L<$$|perlvar/$$> の文書を参照してください。

=head2 C<< $< >>, C<< $> >>, C<$(> and C<$)> are no longer cached

(C<< $< >>, C<< $> >>, C<$(>, C<$)> はキャッシュされません)

=begin original

Similarly to the changes to C<$$> and C<getppid()>, the internal
caching of C<< $< >>, C<< $> >>, C<$(> and C<$)> has been removed.

=end original

C<$$> および C<getppid()> の変更と同様に C<< $< >>, C<< $> >>, C<$(>,
C<$)> の内部キャッシュも削除されました。

=begin original

When we cached these values our idea of what they were would drift out
of sync with reality if someone (e.g., someone embedding perl) called
C<sete?[ug]id()> without updating C<PL_e?[ug]id>.  Having to deal with
this complexity wasn't worth it given how cheap the C<gete?[ug]id()>
system call is.

=end original

When we cached these values our idea of what they were would drift out
of sync with reality if someone (e.g., someone embedding perl) called
C<sete?[ug]id()> without updating C<PL_e?[ug]id>.
この複雑性は C<gete?[ug]id()> の呼び出しコストの低さを考えると割に
合いませんでした。
(TBT)

=begin original

This change will break a handful of CPAN modules that use the XS-level
C<PL_uid>, C<PL_gid>, C<PL_euid> or C<PL_egid> variables.

=end original

この変更により XS レベルの C<PL_uid>, C<PL_gid>, C<PL_euid>,
C<PL_egid> 変数を使っている一握りの CPAN モジュールが動かなくなります。

=begin original

The fix for those breakages is to use C<PerlProc_gete?[ug]id()> to
retrieve them (e.g. C<PerlProc_getuid()>), and not to assign to
C<PL_e?[ug]id> if you change the UID/GID/EUID/EGID.  There is no longer
any need to do so since perl will always retrieve the up-to-date
version of those values from the OS.

=end original

これを修正するには、値を得るのに (C<PerlProc_getuid()> のような)
C<PerlProc_gete?[ug]id()> を使って、もし UID/GID/EUID/EGID を変更するなら
C<PL_e?[ug]id> に代入しないことです。
perl はこれらの値を常に OS から最新の値を取るようになったので、
このようにする必要性はなくなっています。

=head2 Which Non-ASCII characters get quoted by C<quotemeta> and C<\Q> has changed

(C<quotemeta> と C<\Q> でクォートされる非 ASCII 文字が変更されました)

=begin original

This is unlikely to result in a real problem, as Perl does not attach
special meaning to any non-ASCII character, so it is currently
irrelevant which are quoted or not.  This change fixes bug [perl #77654] and
bring Perl's behavior more into line with Unicode's recommendations.
See L<perlfunc/quotemeta>.

=end original

Perl は非 ASCII 文字に特別な意味を割り振っていないために、これが実際の
問題になるとは考えにくいので、今のところクォートされているかどうかは
無関係です。
この変更は [perl #77654] のバグを修正して、Perl の振る舞いを Unicode の
要求により近いものにします。
L<perlfunc/quotemeta> を参照してください。

=head1 Performance Enhancements

=over

=item *

Improved performance for Unicode properties in regular expressions

=for comment Can this be compacted some? -- rjbs, 2012-02-20

Matching a code point against a Unicode property is now done via a
binary search instead of linear.  This means for example that the worst
case for a 1000 item property is 10 probes instead of 1000.  This
inefficiency has been compensated for in the past by permanently storing
in a hash the results of a given probe plus the results for the adjacent
64 code points, under the theory that near-by code points are likely to
be searched for.  A separate hash was used for each mention of a Unicode
property in each regular expression.  Thus, C<qr/\p{foo}abc\p{foo}/>
would generate two hashes.  Any probes in one instance would be unknown
to the other, and the hashes could expand separately to be quite large
if the regular expression were used on many different widely-separated
code points.  This can lead to running out of memory in extreme cases.
Now, however, there is just one hash shared by all instances of a given
property.  This means that if C<\p{foo}> is matched against "A" in one
regular expression in a thread, the result will be known immediately to
all regular expressions, and the relentless march of using up memory is
slowed considerably.

=item *

Version declarations with the C<use> keyword (e.g., C<use 5.012>) are now
faster, as they enable features without loading F<feature.pm>.

=item *

C<local $_> is faster now, as it no longer iterates through magic that it
is not going to copy anyway.

=item *

Perl 5.12.0 sped up the destruction of objects whose classes define
empty C<DESTROY> methods (to prevent autoloading), by simply not
calling such empty methods.  This release takes this optimisation a
step further, by not calling any C<DESTROY> method that begins with a
C<return> statement.  This can be useful for destructors that are only
used for debugging:

    use constant DEBUG => 1;
    sub DESTROY { return unless DEBUG; ... }

Constant-folding will reduce the first statement to C<return;> if DEBUG
is set to 0, triggering this optimisation.

=item *

Assigning to a variable that holds a typeglob or copy-on-write scalar
is now much faster.  Previously the typeglob would be stringified or
the copy-on-write scalar would be copied before being clobbered.

=item *

Assignment to C<substr> in void context is now more than twice its
previous speed.  Instead of creating and returning a special lvalue
scalar that is then assigned to, C<substr> modifies the original string
itself.

=item *

C<substr> no longer calculates a value to return when called in void
context.

=item *

Due to changes in L<File::Glob>, Perl's C<glob> function and its C<<
<...> >> equivalent are now much faster.  The splitting of the pattern
into words has been rewritten in C, resulting in speed-ups of 20% in
some cases.

This does not affect C<glob> on VMS, as it does not use File::Glob.

=item *

The short-circuiting operators C<&&>, C<||>, and C<//>, when chained
(such as C<$a || $b || $c>), are now considerably faster to short-circuit,
due to reduced optree traversal.

=item *

The implementation of C<s///r> makes one fewer copy of the scalar's value.

=item *

C<study> is now a no-op.

=item *

Recursive calls to lvalue subroutines in lvalue scalar context use less
memory.

=back

=head1 Modules and Pragmata

=head2 Deprecated Modules

=over

=item L<Version::Requirements>

Version::Requirements is now DEPRECATED, use L<CPAN::Meta::Requirements>,
which is a drop-in replacement.  It will be deleted from perl.git blead
in v5.17.0.

=back

=head2 New Modules and Pragmata

=over 4

=item *

L<arybase> -- this new module implements the C<$[> variable.

=item *

C<PerlIO::mmap> 0.010 has been added to the Perl core.

The C<mmap> PerlIO layer is no longer implemented by perl itself, but has
been moved out into the new L<PerlIO::mmap> module.

=back

=head2 Updated Modules and Pragmata

=over 4

=item *

L<XXX> has been upgraded from version 0.69 to version 0.70.

=back

=head2 Removed Modules and Pragmata

As promised in Perl 5.14.0's release notes, the following modules have
been removed from the core distribution, and if needed should be installed
from CPAN instead.

=over

=item *

C<Devel::DProf> has been removed from the Perl core.  Prior version was
20110228.00.

=item *

C<Shell> has been removed from the Perl core.  Prior version was 0.72_01.

=back

=head1 Documentation

=head2 New Documentation

=head3 L<perldtrace>

L<perldtrace> describes Perl's DTrace support, listing the provided probes
and gives examples of their use.

=head3 L<perlexperiment>

This document is intended to provide a list of experimental features in
Perl.  It is still a work in progress.

=head3 L<perlootut>

This a new OO tutorial.  It focuses on basic OO concepts, and then recommends
that readers choose an OO framework from CPAN.

=head3 L<perlxstypemap>

The new manual describes the XS typemapping mechanism in unprecedented
detail and combines new documentation with information extracted from
L<perlxs> and the previously unofficial list of all core typemaps.

=head2 Changes to Existing Documentation

=head3 L<perlapi>

=over 4

=item *

The HV API has long accepted negative lengths to indicate that the key is
in UTF8.  Now this is documented.

=item *

The C<boolSV()> macro is now documented.

=back

=head3 L<perlfunc>

=over 4

=item *

C<dbmopen> treats a 0 mode as a special case, that prevents a nonexistent
file from being created.  This has been the case since Perl 5.000, but was
never documented anywhere.  Now the perlfunc entry mentions it
[perl #90064].

=item *

As an accident of history, C<open $fh, "<:", ...> applies the default
layers for the platform (C<:raw> on Unix, C<:crlf> on Windows), ignoring
whatever is declared by L<open.pm|open>.  This seems such a useful feature
it has been documented in L<perlfunc|perlfunc/open> and L<open>.

=item *

The entry for C<split> has been rewritten.  It is now far clearer than
before.

=back

=head3 L<perlguts>

=over 4

=item *

A new section, L<Autoloading with XSUBs|perlguts/Autoloading with XSUBs>,
has been added, which explains the two APIs for accessing the name of the
autoloaded sub.

=item *

Some of the function descriptions in L<perlguts> were confusing, as it was
not clear whether they referred to the function above or below the
description.  This has been clarified [perl #91790].

=back

=head3 L<perlobj>

=over 4

=item *

This document has been rewritten from scratch, and its coverage of various OO
concepts has been expanded.

=back

=head3 L<perlop>

=over 4

=item *

Documentation of the smartmatch operator has been reworked and moved from
perlsyn to perlop where it belongs.

It has also been corrected for the case of C<undef> on the left-hand
side.  The list of different smart match behaviours had an item in the
wrong place.

=item *

Documentation of the ellipsis statement (C<...>) has been reworked and
moved from perlop to perlsyn.

=item *

The explanation of bitwise operators has been expanded to explain how they
work on Unicode strings (5.14.1).

=item *

More examples for C<m//g> have been added (5.14.1).

=item *

The C<<< <<\FOO >>> here-doc syntax has been documented (5.14.1).

=back

=head3 L<perlpragma>

=over 4

=item *

There is now a standard convention for naming keys in the C<%^H>,
documented under L<Key naming|perlpragma/Key naming>.

=back

=head3 L<perlsec/Laundering and Detecting Tainted Data>

=over 4

=item *

The example function for checking for taintedness contained a subtle
error.  C<$@> needs to be localized to prevent its changing this
global's value outside the function.  The preferred method to check for
this remains L<Scalar::Util/tainted>.

=back

=head3 L<perllol>

=over

=item *

L<perllol> has been expanded with examples using the new C<push $scalar>
syntax introduced in Perl 5.14.0 (5.14.1).

=back

=head3 L<perlmod>

=over

=item *

L<perlmod> now states explicitly that some types of explicit symbol table
manipulation are not supported.  This codifies what was effectively already
the case [perl #78074].

=back

=head3 L<perlpodstyle>

=over 4

=item *

The tips on which formatting codes to use have been corrected and greatly
expanded.

=item *

There are now a couple of example one-liners for previewing POD files after
they have been edited.

=back

=head3 L<perlre>

=over

=item *

The C<(*COMMIT)> directive is now listed in the right section
(L<Verbs without an argument|perlre/Verbs without an argument>).

=back

=head3 L<perlrun>

=over

=item *

L<perlrun> has undergone a significant clean-up.  Most notably, the
B<-0x...> form of the B<-0> flag has been clarified, and the final section
on environment variables has been corrected and expanded (5.14.1).

=back

=head3 L<perlsub>

=over

=item *

The ($;) prototype syntax, which has existed for rather a long time, is now
documented in L<perlsub>.  It allows a unary function to have the same
precedence as a list operator.

=back

=head3 L<perltie>

=over

=item *

The required syntax for tying handles has been documented.

=back

=head3 L<perlvar>

=over

=item *

The documentation for L<$!|perlvar/$!> has been corrected and clarified.
It used to state that $! could be C<undef>, which is not the case.  It was
also unclear as to whether system calls set C's C<errno> or Perl's C<$!>
[perl #91614].

=item *

Documentation for L<$$|perlvar/$$> has been amended with additional
cautions regarding changing the process ID.

=back

=head3 Other Changes

=over 4

=item *

L<perlxs> was extended with documentation on inline typemaps.

=item *

L<perlref> has a new L<Circular References|perlref/Circular References>
section explaining how circularities may not be freed and how to solve that
with weak references.

=item *

Parts of L<perlapi> were clarified, and Perl equivalents of some C
functions have been added as an additional mode of exposition.

=item *

A few parts of L<perlre> and L<perlrecharclass> were clarified.

=back

=head2 Removed Documentation

=head3 Old OO Documentation

All the old OO tutorials, perltoot, perltooc, and perlboot, have been
removed.  The perlbot (bag of object tricks) document has been removed
as well.

=head3 Development Deltas

The perldelta files for development releases are no longer packaged with
perl.  These can still be found in the perl source code repository.

=head1 Diagnostics

The following additions or changes have been made to diagnostic output,
including warnings and fatal error messages.  For the complete list of
diagnostic messages, see L<perldiag>.

=head2 New Diagnostics

=head3 New Errors

=over 4

=item *

L<Cannot set tied @DB::args|perldiag/"Cannot set tied @DB::args">

This error occurs when C<caller> tries to set C<@DB::args> but finds it
tied.  Before this error was added, it used to crash instead.

=item *

L<Cannot tie unreifiable array|perldiag/"Cannot tie unreifiable array">

This error is part of a safety check that the C<tie> operator does before
tying a special array like C<@_>.  You should never see this message.

=item *

L<&CORE::%s cannot be called directly|perldiag/"&CORE::%s cannot be called directly">

This occurs when a subroutine in the C<CORE::> namespace is called
with C<&foo> syntax or through a reference.  Some subroutines
in this package cannot yet be called that way, but must be
called as barewords.  See L</Subroutines in the C<CORE> namespace>, above.

=item *

L<Source filters apply only to byte streams|perldiag/"Source filters apply only to byte streams">

This new error occurs when you try to activate a source filter (usually by
loading a source filter module) within a string passed to C<eval> under the
C<unicode_eval> feature.

=back

=head3 New Warnings

=over 4

=item *

L<defined(@array) is deprecated|perldiag/"defined(@array) is deprecated">

The long-deprecated C<defined(@array)> now also warns for package variables.
Previously it only issued a warning for lexical variables.

=item *

L<length() used on %s|perldiag/length() used on %s>

This new warning occurs when C<length> is used on an array or hash, instead
of C<scalar(@array)> or C<scalar(keys %hash)>.

=item *

L<lvalue attribute %s already-defined subroutine|perldiag/"lvalue attribute %s already-defined subroutine">

L<attributes.pm|attributes> now emits this warning when the :lvalue
attribute is applied to a Perl subroutine that has already been defined, as
doing so can have unexpected side-effects.

=item *

L<overload arg '%s' is invalid|perldiag/"overload arg '%s' is invalid">

This warning, in the "overload" category, is produced when the overload
pragma is given an argument it doesn't recognize, presumably a mistyped
operator.

=item *

L<$[ used in %s (did you mean $] ?)|perldiag/"$[ used in %s (did you mean $] ?)">

This new warning exists to catch the mistaken use of C<$[> in version
checks.  C<$]>, not C<$[>, contains the version number.

=item *

L<Useless assignment to a temporary|perldiag/"Useless assignment to a temporary">

Assigning to a temporary scalar returned
from an lvalue subroutine now produces this
warning [perl #31946].

=item *

L<Useless use of \E|perldiag/"Useless use of \E">

C<\E> does nothing unless preceded by C<\Q>, C<\L> or C<\U>.

=back

=head2 Removed Errors

=over

=item *

"sort is now a reserved word"

This error used to occur when C<sort> was called without arguments,
followed by C<;> or C<)>.  (E.g., C<sort;> would die, but C<{sort}> was
OK.)  This error message was added in Perl 3 to catch code like
C<close(sort)> which would no longer work.  More than two decades later,
this message is no longer appropriate.  Now C<sort> without arguments is
always allowed, and returns an empty list, as it did in those cases
where it was already allowed [perl #90030].

=back

=head2 Changes to Existing Diagnostics

=over 4

=item *

The "Applying pattern match..." or similar warning produced when an
array or hash is on the left-hand side of the C<=~> operator now
mentions the name of the variable.

=item *

The "Attempt to free non-existent shared string" has had the spelling
of "non-existent" corrected to "nonexistent".  It was already listed
with the correct spelling in L<perldiag>.

=item *

The error messages for using C<default> and C<when> outside of a
topicalizer have been standardised to match the messages for C<continue>
and loop controls.  They now read 'Can't "default" outside a
topicalizer' and 'Can't "when" outside a topicalizer'.  They both used
to be 'Can't use when() outside a topicalizer' [perl #91514].

=item *

The message, "Code point 0x%X is not Unicode, no properties match it;
all inverse properties do" has been changed to "Code point 0x%X is not
Unicode, all \p{} matches fail; all \P{} matches succeed".

=item *

Redefinition warnings for constant subroutines used to be mandatory,
even occurring under C<no warnings>.  Now they respect the L<warnings>
pragma.

=item *

The "glob failed" warning message is now suppressible via C<no warnings>
[perl #111656].

=item *

The L<Invalid version format|perldiag/"Invalid version format (%s)">
error message now says "negative version number" within the parentheses,
rather than "non-numeric data", for negative numbers.

=item *

The two warnings
L<Possible attempt to put comments in qw() list|perldiag/"Possible attempt to put comments in qw() list">
and
L<Possible attempt to separate words with commas|perldiag/"Possible attempt to separate words with commas">
are no longer mutually exclusive: the same C<qw> construct may produce
both.

=item *

The uninitialized warning for C<y///r> when C<$_> is implicit and
undefined now mentions the variable name, just like the non-/r variation
of the operator.

=item *

The 'Use of "foo" without parentheses is ambiguous' warning has been
extended to apply also to user-defined subroutines with a (;$)
prototype, and not just to built-in functions.

=item *

Warnings that mention the names of lexical (C<my>) variables with
Unicode characters in them now respect the presence or absence of the
C<:utf8> layer on the output handle, instead of outputting UTF8
regardless.  Also, the correct names are included in the strings passed
to C<$SIG{__WARN__}> handlers, rather than the raw UTF8 bytes.

=back

=head1 Utility Changes

=head3 L<h2ph>

=over 4

=item *

L<h2ph> used to generate code of the form

  unless(defined(&FOO)) {
    sub FOO () {42;}
  }

But the subroutine is a compile-time declaration, and is hence unaffected
by the condition.  It has now been corrected to emit a string C<eval>
around the subroutine [perl #99368].

=back

=head3 L<splain>

=over 4

=item *

F<splain> no longer emits backtraces with the first line number repeated.

This:

    Uncaught exception from user code:
            Cannot fwiddle the fwuddle at -e line 1.
     at -e line 1
            main::baz() called at -e line 1
            main::bar() called at -e line 1
            main::foo() called at -e line 1

has become this:

    Uncaught exception from user code:
            Cannot fwiddle the fwuddle at -e line 1.
            main::baz() called at -e line 1
            main::bar() called at -e line 1
            main::foo() called at -e line 1

=item *

Some error messages consist of multiple lines that are listed as separate
entries in L<perldiag>.  splain has been taught to find the separate
entries in these cases, instead of simply failing to find the message.

=back

=head3 L<zipdetails>

=over 4

=item *

This is a new utility, included as part of an
L<IO::Compress::Base> upgrade.

L<zipdetails> displays information about the internal record structure
of the zip file.  It is not concerned with displaying any details of
the compressed data stored in the zip file.

=back

=head1 Configuration and Compilation

=over 4

=item *

The C<-Dusesitecustomize> and C<-Duserelocatableinc> options now work
together properly.

=item *

F<regexp.h> has been modified for compatibility with GCC's B<-Werror>
option, as used by some projects that include perl's header files (5.14.1).

=item *

C<USE_LOCALE{,_COLLATE,_CTYPE,_NUMERIC}> have been added the output of perl -V
as they have affect the behaviour of the interpreter binary (albeit only
in a small area).

=item *

The code and tests for L<IPC::Open2> have been moved from F<ext/IPC-Open2>
into F<ext/IPC-Open3>, as C<IPC::Open2::open2()> is implemented as a thin
wrapper around C<IPC::Open3::_open3()>, and hence is very tightly coupled to
it.

=item *

The magic types and magic vtables are now generated from data in a new script
F<regen/mg_vtable.pl>, instead of being
maintained by hand.  As different EBCDIC
variants can't agree on the code point for '~', the character to code point
conversion is done at build time by F<generate_uudmap> to a new generated header
F<mg_data.h>.  C<PL_vtbl_bm> and C<PL_vtbl_fm> are now defined by the
pre-processor as C<PL_vtbl_regexp>, instead of being distinct C variables.
C<PL_vtbl_sig> has been removed.

=item *

Building with C<-DPERL_GLOBAL_STRUCT>
works again.  This configuration is not
generally used.

=item *

Perl configured with I<MAD> now correctly frees C<MADPROP> structures when
OPs are freed.  C<MADPROP>s are now allocated with
C<PerlMemShared_malloc()>

=back

=head1 Platform Support

=head2 Platform-Specific Notes

=head3 Cygwin

=over 4

=item *

Since version 1.7, Cygwin supports native UTF-8 paths.  If Perl is built
under that environment, directory and filenames will be UTF-8 encoded.

Cygwin does not initialize all original Win32 environment variables.  See
F<README.cygwin> for a discussion of the newly-added
C<Cygwin::sync_winenv()> function [perl #110190] and for
further links.

=back

=head3 VMS

=over 4

=item *

Remove unnecessary includes, fix miscellaneous compiler warnings and
close some unclosed comments on F<vms/vms.c>.

Remove sockadapt layer from the VMS build.

=item *

Explicit support for VMS versions prior to v7.0 and DEC C versions
prior to v6.0 has been removed.

=item *

Since Perl 5.10.1, the home-grown C<stat> wrapper has been unable to
distinguish between a directory name containing an underscore and an
otherwise-identical filename containing a dot in the same position
(e.g., t/test_pl as a directory and t/test.pl as a file).  This problem
has been corrected.

=item *

The build on VMS now allows names of the resulting symbols in C code for
Perl longer than 31 characters.  Symbols like
C<Perl__it_was_the_best_of_times_it_was_the_worst_of_times> can now be
created freely without causing the VMS linker to seize up.

=back

=head3 GNU/Hurd

Numerous build and test failures on GNU/Hurd have been resolved with hints
for building DBM modules, detection of the library search path, and enabling
of large file support.

=head3 OpenVOS

Perl is now built with dynamic linking on OpenVOS, the minimum supported
version of which is now Release 17.1.0.

=head3 SunOS

The CC workshop C++ compiler is now detected and used on systems that ship
without cc.

=head1 Internal Changes

=over 4

=item *

There are now feature bundle hints in C<PL_hints> (C<$^H>) that version
declarations use, to avoid having to load F<feature.pm>.  One setting of
the hint bits indicates a "custom" feature bundle, which means that the
entries in C<%^H> still apply.  F<feature.pm> uses that.

The C<HINT_FEATURE_MASK> macro is defined in F<perl.h> along with other
hints.  Other macros for setting and testing features and bundles are in
the new F<feature.h>.  C<FEATURE_IS_ENABLED> (which has moved to
F<feature.h>) is no longer used throughout the codebase, but more specific
macros, e.g., C<FEATURE_SAY_IS_ENABLED>, that are defined in F<feature.h>.

=item *

F<lib/feature.pm> is now a generated file, created by the new
F<regen/feature.pl> script, which also generates F<feature.h>.

=item *

Tied arrays are now always C<AvREAL>.  If C<@_> or C<DB::args> is tied, it
is reified first, to make sure this is always the case.

=item *

The C<is_gv_magical_sv> function has been eliminated and merged with
C<gv_fetchpvn_flags>.  It used to be called to determine whether a GV
should be autovivified in rvalue context.  Now it has been replaced with a
new C<GV_ADDMG> flag (not part of the API).

=item *

Padlists are now marked C<AvREAL>; i.e., reference-counted.  They have
always been reference-counted, but were not marked real, because F<pad.c>
did its own clean-up, instead of using the usual clean-up code in F<sv.c>.
That caused problems in thread cloning, so now the C<AvREAL> flag is on,
but is turned off in F<pad.c> right before the padlist is freed (after
F<pad.c> has done its custom freeing of the pads).

=item *

All the C files that make up the Perl core have been converted to UTF-8.

=back

=head1 Selected Bug Fixes

=head2 Array and hash

=over

=item *

A bug has been fixed that would cause a "Use of freed value in iteration"
error if the next two hash elements that would be iterated over are
deleted [perl #85026]. (5.14.1)

=item *

Deleting the current hash iterator (the hash element that would be returend
by the next call to C<each>) in void context used not to free it
[perl #85026].

=item *

Deletion of methods via C<delete $Class::{method}> syntax used to update
method caches if called in void context, but not scalar or list context.

=item *

When hash elements are deleted in void context, the internal hash entry is
now freed before the value is freed, to prevent destructors called by that
latter freeing from seeing the hash in an inconsistent state.  It was
possible to cause double-frees if the destructor freed the hash itself
[perl #100340].

=item *

A C<keys> optimisation in Perl 5.12.0 to make it faster on empty hashes
caused C<each> not to reset the iterator if called after the last element
was deleted.

=item *

Freeing deeply nested hashes no longer crashes [perl #44225].

=item *

It is possible from XS code to create hashes with elements that have no
values.  The hash element and slice operators used to crash
when handling these in lvalue context.  They now
produce a "Modification of non-creatable hash value attempted" error
message.

=item *

If list assignment to a hash or array triggered destructors that freed the
hash or array itself, a crash would ensue.  This is no longer the case
[perl #107440].

=item *

It used to be possible to free the typeglob of a localised array or hash
(e.g., C<local @{"x"}; delete $::{x}>), resulting in a crash on scope exit.

=item *

Some core bugs affecting L<Hash::Util> have been fixed: locking a hash
element that is a glob copy no longer causes subsequent assignment to it to
corrupt the glob, and unlocking a hash element that holds a copy-on-write
scalar no longer causes modifications to that scalar to modify other
scalars that were sharing the same string buffer.

=back

=head2 C API fixes

=over

=item *

The C<newHVhv> XS function now works on tied hashes, instead of crashing or
returning an empty hash.

=item *

The C<SvIsCOW> C macro now returns false for read-only copies of typeglobs,
such as those created by:

  $hash{elem} = *foo;
  Hash::Util::lock_value %hash, 'elem';

It used to return true.

=item *

The C<SvPVutf8> C function no longer tries to modify its argument,
resulting in errors [perl #108994].

=item *

C<SvPVutf8> now works properly with magical variables.

=item *

C<SvPVbyte> now works properly non-PVs.

=item *

When presented with malformed UTF-8 input, the XS-callable functions
C<is_utf8_string()>, C<is_utf8_string_loc()>, and
C<is_utf8_string_loclen()> could read beyond the end of the input
string by up to 12 bytes.  This no longer happens.  [perl #32080].
However, currently, C<is_utf8_char()> still has this defect, see
L</is_utf8_char()> above.

=item *

The C-level C<pregcomp> function could become confused as to whether the
pattern was in UTF8 if the pattern was an overloaded, tied, or otherwise
magical scalar [perl #101940].

=back

=head2 Compile-time hints

=over

=item *

Tying C<%^H> no longer causes perl to crash or ignore the contents of
C<%^H> when entering a compilation scope [perl #106282].

=item *

C<eval $string> and C<require> used not to
localise C<%^H> during compilation if it
was empty at the time the C<eval> call itself was compiled.  This could
lead to scary side effects, like C<use re "/m"> enabling other flags that
the surrounding code was trying to enable for its caller [perl #68750].

=item *

C<eval $string> and C<require> no longer localise hints (C<$^H> and C<%^H>)
at run time, but only during compilation of the $string or required file.
This makes C<BEGIN { $^H{foo}=7 }> equivalent to
C<BEGIN { eval '$^H{foo}=7' }> [perl #70151].

=item *

Creating a BEGIN block from XS code (via C<newXS> or C<newATTRSUB>) would,
on completion, make the hints of the current compiling code the current
hints.  This could cause warnings to occur in a non-warning scope.

=back

=head2 Copy-on-write scalars

Copy-on-write or shared hash key scalars
were introduced in 5.8.0, but most Perl code
did not encounter them (they were used mostly internally).  Perl
5.10.0 extended them, such that assigning C<__PACKAGE__> or a
hash key to a scalar would make it copy-on-write.  Several parts
of Perl were not updated to account for them, but have now been fixed.

=over

=item *

C<utf8::decode> had a nasty bug that would modify copy-on-write scalars'
string buffers in place (i.e., skipping the copy).  This could result in
hashes having two elements with the same key [perl #91834].

=item *

Lvalue subroutines were not allowing COW scalars to be returned.  This was
fixed for lvalue scalar context in Perl 5.12.3 and 5.14.0, but list context
was not fixed until this release.

=item *

Elements of restricted hashes (see the L<fields> pragma) containing
copy-on-write values couldn't be deleted, nor could such hashes be cleared
(C<%hash = ()>).

=item *

Localising a tied variable used to make it read-only if it contained a
copy-on-write string.

=item *

Assigning a copy-on-write string to a stash
element no longer causes a double free.  Regardless of this change, the
results of such assignments are still undefined.

=item *

Assigning a copy-on-write string to a tied variable no longer stops that
variable from being tied if it happens to be a PVMG or PVLV internally.

=item *

Doing a substitution on a tied variable returning a copy-on-write
scalar used to cause an assertion failure or an "Attempt to free
nonexistent shared string" warning.

=item *

This one is a regression from 5.12: In 5.14.0, the bitwise assignment
operators C<|=>, C<^=> and C<&=> started leaving the left-hand side
undefined if it happened to be a copy-on-write string [perl #108480].

=item *

L<Storable>, L<Devel::Peek> and L<PerlIO::scalar> had similar problems.
See L</Updated Modules and Pragmata>, above.

=back

=head2 The debugger

=over

=item *

F<dumpvar.pl>, and consequently the C<x> command in the debugger, have been
fixed to handle objects blessed into classes whose names contain "=".  The
contents of such objects used not to be dumped [perl #101814].

=item *

The "R" command for restarting a debugger session has been fixed to work on
Windows, or any other system lacking a C<POSIX::_SC_OPEN_MAX> constant
[perl #87740].

=item *

The C<#line 42 foo> directive used not to update the arrays of lines used
by the debugger if it occurred in a string eval.  This was partially fixed
in 5.14, but it only worked for a single C<#line 42 foo> in each eval.  Now
it works for multiple.

=item *

When subroutine calls are intercepted by the debugger, the name of the
subroutine or a reference to it is stored in C<$DB::sub>, for the debugger
to access.  In some cases (such as C<$foo = *bar; undef *bar; &$foo>)
C<$DB::sub> would be set to a name that could not be used to find the
subroutine, and so the debugger's attempt to call it would fail.  Now the
check to see whether a reference is needed is more robust, so those
problems should not happen anymore [rt.cpan.org #69862].

=item *

Every subroutine has a filename associated with it that the debugger uses.
The one associated with constant subroutines used to be misallocated when
cloned under threads.  Consequently, debugging threaded applications could
result in memory corruption [perl #96126].

=back

=head2 Dereferencing operators

=over

=item *

C<defined(${"..."})>, C<defined(*{"..."})>, etc., used to
return true for most, but not all built-in variables, if
they had not been used yet.  This bug affected C<${^GLOBAL_PHASE}> and
C<${^UTF8CACHE}>, among others.  It also used to return false if the
package name was given as well (C<${"::!"}>) [perl #97978, #97492].

=item *

Perl 5.10.0 introduced a similar bug: C<defined(*{"foo"})> where "foo"
represents the name of a built-in global variable used to return false if
the variable had never been used before, but only on the I<first> call.
This, too, has been fixed.

=item *

Since 5.6.0, C<*{ ... }> has been inconsistent in how it treats undefined
values.  It would die in strict mode or lvalue context for most undefined
values, but would be treated as the empty string (with a warning) for the
specific scalar return by C<undef()> (C<&PL_sv_undef> internally).  This
has been corrected.  C<undef()> is now treated like other undefined
scalars, as in Perl 5.005.

=back

=head2 Filehandle, last-accessed

Perl has an internal variable that stores the last filehandle to be
accessed.  It is used by C<$.> and by C<tell> and C<eof> without
arguments.

=over

=item *

It used to be possible to set this internal variable to a glob copy and
then modify that glob copy to be something other than a glob, and still
have the last-accessed filehandle associated with the variable after
assigning a glob to it again:

    my $foo = *STDOUT;  # $foo is a glob copy
    <$foo>;             # $foo is now the last-accessed handle
    $foo = 3;           # no longer a glob
    $foo = *STDERR;     # still the last-accessed handle

Now the C<$foo = 3> assignment unsets that internal variable, so there
is no last-accessed filehandle, just as if C<< <$foo> >> had never
happened.

This also prevents some unrelated handle from becoming the last-accessed
handle if $foo falls out of scope and the same internal SV gets used for
another handle [perl #97988].

=item *

A regression in 5.14 caused these statements not to set that internal
variable:

    my $fh = *STDOUT;
    tell $fh;
    eof  $fh;
    seek $fh, 0,0;
    tell     *$fh;
    eof      *$fh;
    seek     *$fh, 0,0;
    readline *$fh;

This is now fixed, but C<tell *{ *$fh }> still has the problem, and it
is not clear how to fix it [perl #106536].

=back

=head2 Filetests and C<stat>

The term "filetests" refers to the operators that consist of a hyphen
followed by a single letter: C<-r>, C<-x>, C<-M>, etc.  The term "stacked"
when applied to filetests means followed by another filetest operator
sharing the same operand, as in C<-r -x -w $fooo>.

=over

=item *

C<stat> produces more consistent warnings.  It no longer warns for "_"
[perl #71002] and no longer skips the warning at times for other unopened
handles.  It no longer warns about an unopened handle when the operating
system's C<fstat> function fails.

=item *

C<stat> would sometimes return negative numbers for large inode numbers,
because it was using the wrong internal C type. [perl #84590]

=item *

C<lstat> is documented to fall back to C<stat> (with a warning) when given
a filehandle.  When passed an IO reference, it was actually doing the
equivalent of S<C<stat _>> and ignoring the handle.

=item *

C<-T _> with no preceding C<stat> used to produce a
confusing "uninitialized" warning, even though there
is no visible uninitialized value to speak of.

=item *

C<-T>, C<-B>, C<-l> and C<-t> now work
when stacked with other filetest operators
[perl #77388].

=item *

In 5.14.0, filetest ops (C<-r>, C<-x>, etc.) started calling FETCH on a
tied argument belonging to the previous argument to a list operator, if
called with a bareword argument or no argument at all.  This has been
fixed, so C<push @foo, $tied, -r> no longer calls FETCH on C<$tied>.

=item *

In Perl 5.6, C<-l> followed by anything other than a bareword would treat
its argument as a file name.  That was changed in 5.8 for glob references
(C<\*foo>), but not for globs themselves (C<*foo>).  C<-l> started
returning C<undef> for glob references without setting the last
stat buffer that the "_" handle uses, but only if warnings
were turned on.  With warnings off, it was the same as 5.6.
In other words, it was simply buggy and inconsistent.  Now the 5.6
behaviour has been restored.

=item *

C<-l> followed by a bareword no longer "eats" the previous argument to
the list operator in whose argument list it resides.  Hence,
C<print "bar", -l foo> now actually prints "bar", because C<-l>
on longer eats it.

=item *

Perl keeps several internal variables to keep track of the last stat
buffer, from which file(handle) it originated, what type it was, and
whether the last stat succeeded.

There were various cases where these could get out of synch, resulting in
inconsistent or erratic behaviour in edge cases (every mention of C<-T>
applies to C<-B> as well):

=over

=item *

C<-T I<HANDLE>>, even though it does a C<stat>, was not resetting the last
stat type, so an C<lstat _> following it would merrily return the wrong
results.  Also, it was not setting the success status.

=item *

Freeing the handle last used by C<stat> or a filetest could result in
S<C<-T _>> using an unrelated handle.

=item *

C<stat> with an IO reference would not reset the stat type or record the
filehandle for S<C<-T _>> to use.

=item *

Fatal warnings could cause the stat buffer not to be reset
for a filetest operator on an unopened filehandle or C<-l> on any handle.
Fatal warnings also stopped C<-T> from setting C<$!>.

=item *

When the last stat was on an unreadable file, C<-T _> is supposed to
return C<undef>, leaving the last stat buffer unchanged.  But it was
setting the stat type, causing C<lstat _> to stop working.

=item *

C<-T I<FILENAME>> was not resetting the internal stat buffers for
unreadable files.

=back

These have all been fixed.

=back

=head2 Formats

=over

=item *

A number of edge cases have been fixed with formats and C<formline>;
in particular, where the format itself is potentially variable (such as
with ties and overloading), and where the format and data differ in their
encoding.  In both these cases, it used to possible for the output to be
corrupted [perl #91032].

=item *

C<formline> no longer converts its argument into a string in-place.  So
passing a reference to C<formline> no longer destroys the reference
[perl #79532].

=item *

Assignment to C<$^A> (the format output accumulator) now recalculates
the number of lines output.

=back

=head2 C<given> and C<when>

=over

=item *

C<given> was not scoping its implicit $_ properly, resulting in memory
leaks or "Variable is not available" warnings [perl #94682].

=item *

C<given> was not calling set-magic on the implicit lexical C<$_> that it
uses.  This meant, for example, that C<pos> would be remembered from one
execution of the same C<given> block to the next, even if the input were a
different variable [perl #84526].

=item *

C<when> blocks are now capable of returning variables declared inside the
enclosing C<given> block [perl #93548].

=back

=head2 The C<glob> operator

=over

=item *

On OSes other than VMS, Perl's C<glob> operator (and the C<< <...> >> form)
use L<File::Glob> underneath.  L<File::Glob> splits the pattern into words,
before feeding each word to its C<bsd_glob> function.

There were several inconsistencies in the way the split was done.  Now
quotation marks (' and ") are always treated as shell-style word delimiters
(that allow whitespace as part of a word) and backslashes are always
preserved, unless they exist to escape quotation marks.  Before, those
would only sometimes be the case, depending on whether the pattern
contained whitespace.  Also, escaped whitespace at the end of the pattern
is no longer stripped [perl #40470].

=item *

C<CORE::glob> now works as a way to call the default globbing function.  It
used to respect overrides, despite the C<CORE::> prefix.

=item *

Under miniperl (used to configure modules when perl itself is built),
C<glob> now clears %ENV before calling csh, since the latter croaks on some
systems if it does not like the contents of the LS_COLORS enviroment
variable [perl #98662].

=back

=head2 Lvalue subroutines

=over

=item *

Explicit return now returns the actual argument passed to return, instead
of copying it [perl #72724, #72706].

=item *

Lvalue subroutines used to enforce lvalue syntax (i.e., whatever can go on
the left-hand side of C<=>) for the last statement and the arguments to
return.  Since lvalue subroutines are not always called in lvalue context,
this restriction has been lifted.

=item *

Lvalue subroutines are less restrictive as to what values can be returned.
It used to croak on values returned by C<shift> and C<delete> and from
other subroutines, but no longer does so [perl #71172].

=item *

Empty lvalue subroutines (C<sub :lvalue {}>) used to return C<@_> in list
context.  In fact, all subroutines used to, but regular subs were fixed in
Perl 5.8.2.  Now lvalue subroutines have been likewise fixed.

=item *

Autovivification now works on values returned from lvalue subroutines
[perl #7946], as does returning C<keys> in lvalue context.

=item *

Lvalue subroutines used to copy their return values in rvalue context.  Not
only was this a waste of CPU cycles, but it also caused bugs.  A C<($)>
prototype would cause an lvalue sub to copy its return value [perl #51408],
and C<while(lvalue_sub() =~ m/.../g) { ... }> would loop endlessly
[perl #78680].

=item *

When called in potential lvalue context
(e.g., subroutine arguments or a list
passed to C<for>), lvalue subroutines used to copy
any read-only value that was returned.  E.g., C< sub :lvalue { $] } >
would not return C<$]>, but a copy of it.

=item *

When called in potential lvalue context, an lvalue subroutine returning
arrays or hashes used to bind the arrays or hashes to scalar variables,
resulting in bugs.  This was fixed in 5.14.0 if an array were the first
thing returned from the subroutine (but not for C<$scalar, @array> or
hashes being returned).  Now a more general fix has been applied
[perl #23790].

=item *

Method calls whose arguments were all surrounded with C<my()> or C<our()>
(as in C<< $object->method(my($a,$b)) >>) used to force lvalue context on
the subroutine.  This would prevent lvalue methods from returning certain
values.

=item *

Lvalue sub calls that are not determined to be such at compile time
(C<&$name> or &{"name"}) are no longer exempt from strict refs if they
occur in the last statement of an lvalue subroutine [perl #102486].

=item *

Sub calls whose subs are not visible at compile time, if
they occurred in the last statement of an lvalue subroutine,
would reject non-lvalue subroutines and die with "Can't modify non-lvalue
subroutine call" [perl #102486].

Non-lvalue sub calls whose subs I<are> visible at compile time exhibited
the opposite bug.  If the call occurred in the last statement of an lvalue
subroutine, there would be no error when the lvalue sub was called in
lvalue context.  Perl would blindly assign to the temporary value returned
by the non-lvalue subroutine.

=item *

C<AUTOLOAD> routines used to take precedence over the actual sub being
called (i.e., when autoloading wasn't needed), for sub calls in lvalue or
potential lvalue context, if the subroutine was not visible at compile
time.

=item *

Applying the C<:lvalue> attribute to an XSUB or to an aliased subroutine
stub with C<< sub foo :lvalue; >> syntax stopped working in Perl 5.12.
This has been fixed.

=item *

Applying the :lvalue attribute to subroutine that is already defined does
not work properly, as the attribute changes the way the sub is compiled.
Hence, Perl 5.12 began warning when an attempt is made to apply the
attribute to an already defined sub.  In such cases, the attribute is
discarded.

But the change in 5.12 missed the case where custom attributes are also
present: that case still silently and ineffectively applied the attribute.
That omission has now been corrected.  C<sub foo :lvalue :Whatever> (when
C<foo> is already defined) now warns about the :lvalue attribute, and does
not apply it.

=item *

A bug affecting lvalue context propagation through nested lvalue subroutine
calls has been fixed.  Previously, returning a value in nested rvalue
context would be treated as lvalue context by the inner subroutine call,
resulting in some values (such as read-only values) being rejected.

=back

=head2 Overloading

=over

=item *

Arithmetic assignment (C<$left += $right>) involving overloaded objects
that rely on the 'nomethod' override no longer segfault when the left
operand is not overloaded.

=item *

Errors that occur when methods cannot be found during overloading now
mention the correct package name, as they did in 5.8.x, instead of
erroneously mentioning the "overload" package, as they have since 5.10.0.

=item *

Undefining C<%overload::> no longer causes a crash.

=back

=head2 Prototypes of built-in keywords

=over

=item *

The C<prototype> function no longer dies for the C<__FILE__>, C<__LINE__>
and C<__PACKAGE__> directives.  It now returns an empty-string prototype
for them, because they are syntactically indistinguishable from nullary
functions like C<time>.

=item *

C<prototype> now returns C<undef> for all overridable infix operators,
such as C<eq>, which are not callable in any way resembling functions.
It used to return incorrect prototypes for some and die for others
[perl #94984].

=item *

The prototypes of several built-in functions--C<getprotobynumber>, C<lock>,
C<not> and C<select>--have been corrected, or at least are now closer to
reality than before.

=back

=head2 Regular expressions

=for comment Is it possible to merge some of these items?

=over 4

=item *

C</[[:ascii:]]/> and C</[[:blank:]]/> now use locale rules under
C<use locale> when the platform supports that.  Previously, they used
the platform's native character set.

=item *

C<m/[[:ascii:]]/i> and C</\p{ASCII}/i> now match identically (when not
under a differing locale).  This fixes a regression introduced in 5.14
in which the first expression could match characters outside of ASCII,
such as the KELVIN SIGN.

=item *

C</.*/g> would sometimes refuse to match at the end of a string that ends
with "\n".  This has been fixed [perl #109206].

=item *

Starting with 5.12.0, Perl used to get its internal bookkeeping muddled up
after assigning C<${ qr// }> to a hash element and locking it with
L<Hash::Util>.  This could result in double frees, crashes or erratic
behaviour.

=item *

The new (in 5.14.0) regular expression modifier C</a> when repeated like
C</aa> forbids the characters outside the ASCII range that match
characters inside that range from matching under C</i>.  This did not
work under some circumstances, all involving alternation, such as:

 "\N{KELVIN SIGN}" =~ /k|foo/iaa;

succeeded inappropriately.  This is now fixed.

=item *

5.14.0 introduced some memory leaks in regular expression character
classes such as C<[\w\s]>, which have now been fixed. (5.14.1)

=item *

An edge case in regular expression matching could potentially loop.
This happened only under C</i> in bracketed character classes that have
characters with multi-character folds, and the target string to match
against includes the first portion of the fold, followed by another
character that has a multi-character fold that begins with the remaining
portion of the fold, plus some more.

 "s\N{U+DF}" =~ /[\x{DF}foo]/i

is one such case.  C<\xDF> folds to C<"ss">. (5.14.1)

=item *

A few characters in regular expression pattern matches did not
match correctly in some circumstances, all involving C</i>.  The
affected characters are:
COMBINING GREEK YPOGEGRAMMENI,
GREEK CAPITAL LETTER IOTA,
GREEK CAPITAL LETTER UPSILON,
GREEK PROSGEGRAMMENI,
GREEK SMALL LETTER IOTA WITH DIALYTIKA AND OXIA,
GREEK SMALL LETTER IOTA WITH DIALYTIKA AND TONOS,
GREEK SMALL LETTER UPSILON WITH DIALYTIKA AND OXIA,
GREEK SMALL LETTER UPSILON WITH DIALYTIKA AND TONOS,
LATIN SMALL LETTER LONG S,
LATIN SMALL LIGATURE LONG S T,
and
LATIN SMALL LIGATURE ST.

=item *

A memory leak regression in regular expression compilation
under threading has been fixed.

=item *

A regression introduced in 5.13.6 has
been fixed.  This involved an inverted
bracketed character class in a regular expression that consisted solely
of a Unicode property.  That property wasn't getting inverted outside the
Latin1 range.

=item *

Three problematic Unicode characters now work better in regex pattern matching under C</i>

In the past, three Unicode characters:
LATIN SMALL LETTER SHARP S,
GREEK SMALL LETTER IOTA WITH DIALYTIKA AND TONOS,
and
GREEK SMALL LETTER UPSILON WITH DIALYTIKA AND TONOS,
along with the sequences that they fold to
(including "ss" in the case of LATIN SMALL LETTER SHARP S),
did not properly match under C</i>.  5.14.0 fixed some of these cases,
but introduced others, including a panic when one of the characters or
sequences was used in the C<(?(DEFINE)> regular expression predicate.
The known bugs that were introduced in 5.14 have now been fixed; as well
as some other edge cases that have never worked until now.  All these
involve using the characters and sequences outside bracketed character
classes under C</i>.  This closes [perl #98546].

There remain known problems when using certain characters with
multi-character folds inside bracketed character classes, including such
constructs as C<qr/[\N{LATIN SMALL LETTER SHARP}a-z]/i>.  These
remaining bugs are addressed in [perl #89774].

=item *

RT #78266: The regex engine has been leaking memory when accessing
named captures that weren't matched as part of a regex ever since 5.10
when they were introduced, e.g. this would consume over a hundred MB of
memory:

    for (1..10_000_000) {
        if ("foo" =~ /(foo|(?<capture>bar))?/) {
            my $capture = $+{capture}
        }
    }
    system "ps -o rss $$"'

=item *

In 5.14, C</[[:lower:]]/i> and C</[[:upper:]]/i> no longer matched the
opposite case.  This has been fixed [perl #101970].

=item *

A regular expression match with an overloaded object on the right-hand side
would in some cases stringify the object too many times.

=item *

A regression has been fixed that was introduced in 5.14, in C</i>
regular expression matching, in which a match improperly fails if the
pattern is in UTF-8, the target string is not, and a Latin-1 character
precedes a character in the string that should match the pattern.
[perl #101710]

=item *

In case-insensitive regular expression pattern matching, no longer on
UTF-8 encoded strings does the scan for the start of match only look at
the first possible position.  This caused matches such as
C<"f\x{FB00}" =~ /ff/i> to fail.

=item *

The regexp optimiser no longer crashes on debugging builds when merging
fixed-string nodes with inconvenient contents.

=item *

A panic involving the combination of the regular expression modifiers
C</aa> and the C<\b> escape sequence introduced in 5.14.0 has been
fixed [perl #95964].

=item *

The combination of the regular expression modifiers C</aa> and the C<\b>
and C<\B> escape sequences did not work properly on UTF-8 encoded
strings.  All non-ASCII characters under C</aa> should be treated as
non-word characters, but what was happening was that Unicode rules were
used to determine wordness/non-wordness for non-ASCII characters.  This
is now fixed [perl #95968].

=item *

C<< (?foo: ...) >> no longer loses passed in character set.

=item *

The trie optimisation used to have problems with alternations containing
an empty C<(?:)>, causing C<< "x" =~ /\A(?>(?:(?:)A|B|C?x))\z/ >> not to
match, whereas it should [perl #111842].

=item *

Use of lexical (C<my>) variables in code blocks embedded in regular
expressions will no longer result in memory corruption or crashes.

Nevertheless, these code blocks are still experimental, as there are still
problems with the wrong variables being closed over (in loops for instance)
and with abnormal exiting (e.g., C<die>) causing memory corruption.

=item *

The C<\h>, C<\H>, C<\v> and C<\V> regular expression metacharacters used to
cause a panic error message when attempting to match at the end of the
string [perl #96354].

=item *

The abbreviations for four C1 control characters C<MW> C<PM>, C<RI>, and
C<ST> were previously unrecognized by C<\N{}>, vianame(), and
string_vianame().

=item *

Mentioning a variable named "&" other than C<$&> (i.e., C<@&> or C<%&>) no
longer stops C<$&> from working.  The same applies to variables named "'"
and "`" [perl #24237].

=item *

Creating a C<UNIVERSAL::AUTOLOAD> sub no longer stops C<%+>, C<%-> and
C<%!> from working some of the time [perl #105024].

=back

=head2 Smartmatching

=over

=item *

C<~~> now correctly handles the precedence of Any~~Object, and is not tricked
by an overloaded object on the left-hand side.

=item *

In Perl 5.14.0, C<$tainted ~~ @array> stopped working properly.  Sometimes
it would erroneously fail (when C<$tainted> contained a string that occurs
in the array I<after> the first element) or erroneously succeed (when
C<undef> occurred after the first element) [perl #93590].

=back

=head2 The C<sort> operator

=over

=item *

C<sort> was not treating C<sub {}> and C<sub {()}> as equivalent when
such a sub was provided as the comparison routine.  It used to croak on
C<sub {()}>.

=item *

C<sort> now works once more with custom sort routines that are XSUBs.  It
stopped working in 5.10.0.

=item *

C<sort> with a constant for a custom sort routine, although it produces
unsorted results, no longer crashes.  It started crashing in 5.10.0.

=item *

Warnings emitted by C<sort> when a custom comparison routine returns a
non-numeric value now contain "in sort" and show the line number of the
C<sort> operator, rather than the last line of the comparison routine.  The
warnings also occur now only if warnings are enabled in the scope where
C<sort> occurs.  Previously the warnings would occur if enabled in the
comparison routine's scope.

=item *

C<< sort { $a <=> $b } >>, which is optimised internally, now produces
"uninitialized" warnings for NaNs (not-a-number values), since C<< <=> >>
returns C<undef> for those.  This brings it in line with
S<C<< sort { 1; $a <=> $b } >>> and other more complex cases, which are not
optimised [perl #94390].

=back

=head2 The C<substr> operator

=over

=item *

Tied (and otherwise magical) variables are no longer exempt from the
"Attempt to use reference as lvalue in substr" warning.

=item *

That warning now occurs when the returned lvalue is assigned to, not
when C<substr> itself is called.  This only makes a difference if the
return value of C<substr> is referenced and assigned to later.

=item *

Passing a substring of a read-only value or a typeglob to a function
(potential lvalue context) no longer causes an immediate "Can't coerce"
or "Modification of a read-only value" error.  That error only occurs
if and when the value passed is assigned to.

The same thing happens with the "substr outside of string" error.  If
the lvalue is only read, not written to, it is now just a warning, as
with rvalue C<substr>.

=item *

C<substr> assignments no longer call FETCH twice if the first argument
is a tied variable, just once.

=back

=head2 Support for embedded nulls

Some parts of Perl did not work correctly with nulls (C<chr 0>) embedded in
strings.  That meant that, for instance, C<< $m = "a\0b"; foo->$m >> would
call the "a" method, instead of the actual method name contained in $m.
These parts of perl have been fixed to support nulls:

=over

=item *

Method names

=item *

Typeglob names (including filehandle and subroutine names)

=item *

Package names, including the return value of C<ref()>

=item *

Typeglob elements (C<*foo{"THING\0stuff"}>)

=item *

Signal names

=item *

Various warnings and error messages that mention variable names or values,
methods, etc.

=back

One side effect of these changes is that blessing into "\0" no longer
causes C<ref()> to return false.

=head2 Threading bugs

=over

=item *

Typeglobs returned from threads are no longer cloned if the parent thread
already has a glob with the same name.  This means that returned
subroutines will now assign to the right package variables [perl #107366].

=item *

Some cases of threads crashing due to memory allocation during cloning have
been fixed [perl #90006].

=item *

Thread joining would sometimes emit "Attempt to free unreferenced scalar"
warnings if C<caller> had been used from the C<DB> package prior to thread
creation [perl #98092].

=item *

Locking a subroutine (via C<lock &sub>) is no longer a compile-time error
for regular subs.  For lvalue subroutines, it no longer tries to return the
sub as a scalar, resulting in strange side effects like C<ref \$_>
returning "CODE" in some instances.

C<lock &sub> is now a run-time error if L<threads::shared> is loaded (a
no-op otherwise), but that may be rectified in a future version.

=back

=head2 Tied variables

=over

=item *

Various cases in which FETCH was being ignored or called too many times
have been fixed:

=over

=item *

C<PerlIO::get_layers> [perl #97956]

=item *

C<$tied =~ y/a/b/>, C<chop $tied> and C<chomp $tied> when $tied holds a
reference.

=item *

When calling C<local $_> [perl #105912]

=item *

Four-argument C<select>

=item *

A tied buffer passed to C<sysread>

=item *

C<< $tied .= <> >>

=item *

Three-argument C<open>, the third being a tied file handle
(as in C<< open $fh, ">&", $tied >>)

=item *

C<sort> with a reference to a tied glob for the comparison routine.

=item *

C<..> and C<...> in list context [perl #53554].

=item *

C<${$tied}>, C<@{$tied}>, C<%{$tied}> and C<*{$tied}> where the tied
variable returns a string (C<&{}> was unaffected)

=item *

C<defined ${ $tied_variable }>

=item *

Various functions that take a filehandle argument in rvalue context
(C<close>, C<readline>, etc.) [perl #97482]

=item *

Some cases of dereferencing a complex expression, such as
C<${ (), $tied } = 1>, used to call C<FETCH> multiple times, but now call
it once.

=item *

C<$tied-E<gt>method> where $tied returns a package name--even resulting in
a failure to call the method, due to memory corruption

=item *

Assignments like C<*$tied = \&{"..."}> and C<*glob = $tied>

=item *

C<chdir>, C<chmod>, C<chown>, C<utime>, C<truncate>, C<stat>, C<lstat> and
the filetest ops (C<-r>, C<-x>, etc.)

=back

=item *

C<caller> sets C<@DB::args> to the subroutine arguments when called from
the DB package.  It used to crash when doing so if C<@DB::args> happened to
be tied.  Now it croaks instead.

=item *

Tying an element of %ENV or C<%^H> and then deleting that element would
result in a call to the tie object's DELETE method, even though tying the
element itself is supposed to be equivalent to tying a scalar (the element
is, of course, a scalar) [perl #67490].

=item *

When Perl autovivifies an element of a tied array or hash (which entails
calling STORE with a new reference), it now calls FETCH immediately after
the STORE, instead of assuming that FETCH would have returned the same
reference.  This can make it easier to implement tied objects [perl #35865, #43011].

=item *

Four-argument C<select> no longer produces its "Non-string passed as
bitmask" warning on tied or tainted variables that are strings.

=item *

Localising a tied scalar that returns a typeglob no longer stops it from
being tied till the end of the scope.

=item *

Attempting to C<goto> out of a tied handle method used to cause memory
corruption or crashes.  Now it produces an error message instead
[perl #8611].

=item *

A bug has been fixed that occurs when a tied variable is used as a
subroutine reference:  if the last thing assigned to or returned from the
variable was a reference or typeglob, the C<\&$tied> could either crash or
return the wrong subroutine.  The reference case is a regression introduced
in Perl 5.10.0.  For typeglobs, it has probably never worked till now.

=back

=head2 Version objects and vstrings

=over

=item *

The bitwise complement operator (and possibly other operators, too) when
passed a vstring would leave vstring magic attached to the return value,
even though the string had changed.  This meant that
C<< version->new(~v1.2.3) >> would create a version looking like "v1.2.3"
even though the string passed to C<< version->new >> was actually
"\376\375\374".  This also caused L<B::Deparse> to deparse C<~v1.2.3>
incorrectly, without the C<~> [perl #29070].

=item *

Assigning a vstring to a magic (e.g., tied, C<$!>) variable and then
assigning something else used to blow away all the magic.  This meant that
tied variables would come undone, C<$!> would stop getting updated on
failed system calls, C<$|> would stop setting autoflush, and other
mischief would take place.  This has been fixed.

=item *

C<< version->new("version") >> and C<printf "%vd", "version"> no longer
crash [perl #102586].

=item *

Version comparisons, such as those that happen implicitly with C<use
v5.43>, no longer cause locale settings to change [perl #105784].

=item *

Version objects no longer cause memory leaks in boolean context
[perl #109762].

=back

=head2 Warnings, redefinition

=over

=item *

Subroutines from the C<autouse> namespace are once more exempt from
redefinition warnings.  This used to work in 5.005, but was broken in
5.6 for most subroutines.  For subs created via XS that redefine
subroutines from the C<autouse> package, this stopped working in 5.10.

=item *

New XSUBs now produce redefinition warnings if they overwrite existing
subs, as they did in 5.8.x.  (The C<autouse> logic was reversed in
5.10-14.  Only subroutines from the C<autouse> namespace would warn
when clobbered.)

=item *

C<newCONSTSUB> used to use compile-time warning hints, instead of
run-time hints.  The following code should never produce a redefinition
warning, but it used to, if C<newCONSTSUB> redefined an existing
subroutine:

    use warnings;
    BEGIN {
        no warnings;
        some_XS_function_that_calls_new_CONSTSUB();
    }

=item *

Redefinition warnings for constant subroutines are on by default (what
are known as severe warnings in L<perldiag>).  This was only the case
when it was a glob assignment or declaration of a Perl subroutine that
caused the warning.  If the creation of XSUBs triggered the warning, it
was not a default warning.  This has been corrected.

=item *

The internal check to see whether a redefinition warning should occur
used to emit "uninitialized" warnings in cases like this:

    use warnings "uninitialized";
    use constant {u => undef, v => undef};
    sub foo(){u}
    sub foo(){v}

=back

=head2 Warnings, "Uninitialized"

=over

=item *

Various functions that take a filehandle argument in rvalue context
(C<close>, C<readline>, etc.) used to warn twice for an undefined handle
[perl #97482].

=item *

C<dbmopen> now only warns once, rather than three times, if the mode
argument is C<undef> [perl #90064].

=item *

The C<+=> operator does not usually warn when the left-hand side is
C<undef>, but it was doing so for tied variables.  This has been fixed
[perl #44895].

=item *

A bug fix in Perl 5.14 introduced a new bug, causing "uninitialized"
warnings to report the wrong variable if the operator in question had
two operands and one was C<%{...}> or C<@{...}>.  This has been fixed
[perl #103766].

=item *

C<..> and C<...> in list context now mention the name of the variable in
"uninitialized" warnings for string (as opposed to numeric) ranges.

=back

=head2 Weak references

=over

=item *

Weakening the first argument to an automatically-invoked C<DESTROY> method
could result in erroneous "DESTROY created new reference" errors or
crashes.  Now it is an error to weaken a read-only reference.

=item *

Weak references to lexical hashes going out of scope were not going stale
(becoming undefined), but continued to point to the hash.

=item *

Weak references to lexical variables going out of scope are now broken
before any magical methods (e.g., DESTROY on a tie object) are called.
This prevents such methods from modifying the variable that will be seen
the next time the scope is entered.

=item *

Creating a weak reference to an @ISA array or accessing the array index
(C<$#ISA>) could result in confused internal bookkeeping for elements
subsequently added to the @ISA array.  For instance, creating a weak
reference to the element itself could push that weak reference on to @ISA;
and elements added after use of C<$#ISA> would be ignored by method lookup
[perl #85670].

=back

=head2 Other notable fixes

=over

=item *

C<quotemeta> now quotes consistently the same non-ASCII characters under
C<use feature 'unicode_strings'>, regardless of whether the string is
encoded in UTF-8 or not, hence fixing the last vestiges (we hope) of the
infamous L<perlunicode/The "Unicode Bug">.  [perl #77654].

Which of these code points is quoted has changed, based on Unicode's
recommendations.  See L<perlfunc/quotemeta> for details.

=item *

When one writes C<open foo || die>, which used to work in Perl 4, a
"Precedence problem" warning is produced.  This warning used erroneously to
apply to fully-qualified bareword handle names not followed by C<||>.  This
has been corrected.

=item *

After package aliasing (C<*foo:: = *bar::>), C<select> with 0 or 1 argument
would sometimes return a name that could not be used to refer to the
filehandle, or sometimes it would return C<undef> even when a filehandle
was selected.  Now it returns a typeglob reference in such cases.

=item *

C<PerlIO::get_layers> no longer ignores some arguments that it thinks are
numeric, while treating others as filehandle names.  It is now consistent
for flat scalars (i.e., not references).

=item *

Unrecognised switches on C<#!> line

If a switch, such as B<-x>, that cannot occur on the C<#!> line is used
there, perl dies with "Can't emulate...".

It used to produce the same message for switches that perl did not
recognise at all, whether on the command line or the C<#!> line.

Now it produces the "Unrecognized switch" error message [perl #104288].

=item *

C<system> now temporarily blocks the SIGCHLD signal handler, to prevent the
signal handler from stealing the exit status [perl #105700].

=item *

The %n formatting code for C<printf> and C<sprintf>, which causes the number
of characters to be assigned to the next argument, now actually
assigns the number of characters, instead of the number of bytes.

It also works now with special lvalue functions like C<substr> and with
nonexistent hash and array elements [perl #3471, #103492].

=item *

Perl skips copying values returned from a subroutine, for the sake of
speed, if doing so would make no observable difference.  Due to faulty
logic, this would happen with the
result of C<delete>, C<shift> or C<splice>, even if the result was
referenced elsewhere.  It also did so with tied variables about to be freed
[perl #91844, #95548].

=item *

C<utf8::decode> now refuses to modify read-only scalars [perl #91850].

=item *

Freeing $_ inside a C<grep> or C<map> block, a code block embedded in a
regular expression, or an @INC filter (a subroutine returned by a
subroutine in @INC) used to result in double frees or crashes
[perl #91880, #92254, #92256].

=item *

C<eval> returns C<undef> in scalar context or an empty list in list
context when there is a run-time error.  When C<eval> was passed a
string in list context and a syntax error occurred, it used to return a
list containing a single undefined element.  Now it returns an empty
list in list context for all errors [perl #80630].

=item *

C<goto &func> no longer crashes, but produces an error message, when
the unwinding of the current subroutine's scope fires a destructor that
undefines the subroutine being "goneto" [perl #99850].

=item *

Perl now holds an extra reference count on the package that code is
currently compiling in.  This means that the following code no longer
crashes [perl #101486]:

    package Foo;
    BEGIN {*Foo:: = *Bar::}
    sub foo;

=item *

The C<x> repetition operator no longer crashes on 64-bit builds with large
repeat counts [perl #94560].

=item *

Calling C<require> on an implicit C<$_> when C<*CORE::GLOBAL::require> has
been overridden does not segfault anymore, and C<$_> is now passed to the
overriding subroutine [perl #78260].

=item *

C<use> and C<require> are no longer affected by the I/O layers active in
the caller's scope (enabled by L<open.pm|open>) [perl #96008].

=item *

C<our $::é; $é> (which is invalid) no longer produces the "Compilation
error at lib/utf8_heavy.pl..." error message, which it started emitting in
5.10.0 [perl #99984].

=item *

On 64-bit systems, C<read()> now understands large string offsets beyond
the 32-bit range.

=item *

Errors that occur when processing subroutine attributes no longer cause the
subroutine's op tree to leak.

=item *

Passing the same constant subroutine to both C<index> and C<formline> no
longer causes one or the other to fail [perl #89218]. (5.14.1)

=item *

List assignment to lexical variables declared with attributes in the same
statement (C<my ($x,@y) : blimp = (72,94)>) stopped working in Perl 5.8.0.
It has now been fixed.

=item *

Perl 5.10.0 introduced some faulty logic that made "U*" in the middle of
a pack template equivalent to "U0" if the input string was empty.  This has
been fixed [perl #90160].

=item *

Destructors on objects were not called during global destruction on objects
that were not referenced by any scalars.  This could happen if an array
element were blessed (e.g., C<bless \$a[0]>) or if a closure referenced a
blessed variable (C<bless \my @a; sub foo { @a }>).

Now there is an extra pass during global destruction to fire destructors on
any objects that might be left after the usual passes that check for
objects referenced by scalars [perl #36347].

=item *

Fixed a case where it was possible that a freed buffer may have been read
from when parsing a here document [perl #90128]. (5.14.1)

=item *

C<each(I<ARRAY>)> is now wrapped in C<defined(...)>, like C<each(I<HASH>)>,
inside a C<while> condition [perl #90888].

=item *

A problem with context propagation when a C<do> block is an argument to
C<return> has been fixed.  It used to cause C<undef> to be returned in
some cases of a C<return> inside an C<if> block which itself is followed by
another C<return>.

=item *

Calling C<index> with a tainted constant no longer causes constants in
subsequently compiled code to become tainted [perl #64804].

=item *

Infinite loops like C<1 while 1> used to stop C<strict 'subs'> mode from
working for the rest of the block.t

=item *

For list assignments like C<($a,$b) = ($b,$a)>, Perl has to make a copy of
the items on the right-hand side before assignment them to the left.  For
efficiency's sake, it assigns the values on the right straight to the items
on the left if no one variable is mentioned on both sides, as in C<($a,$b) =
($c,$d)>.  The logic for determining when it can cheat was faulty, in that
C<&&> and C<||> on the right-hand side could fool it.  So C<($a,$b) =
$some_true_value && ($b,$a)> would end up assigning the value of C<$b> to
both scalars.

=item *

Perl no longer tries to apply lvalue context to the string in
C<("string", $variable) ||= 1> (which used to be an error).  Since the
left-hand side of C<||=> is evaluated in scalar context, that's a scalar
comma operator, which gives all but the last item void context.  There is
no such thing as void lvalue context, so it was a mistake for Perl to try
to force it [perl #96942].

=item *

C<caller> no longer leaks memory when called from the DB package if
C<@DB::args> was assigned to after the first call to C<caller>.  L<Carp>
was triggering this bug [perl #97010].

=item *

C<close> and similar filehandle functions, when called on built-in global
variables (like C<$+>), used to die if the variable happened to hold the
undefined value, instead of producing the usual "Use of uninitialized
value" warning.

=item *

When autovivified file handles were introduced in Perl 5.6.0, C<readline>
was inadvertently made to autovivify when called as C<readline($foo)> (but
not as C<E<lt>$fooE<gt>>).  It has now been fixed never to autovivify.

=item *

Calling an undefined anonymous subroutine (e.g., what $x holds after
C<undef &{$x = sub{}}>) used to cause a "Not a CODE reference" error, which
has been corrected to "Undefined subroutine called" [perl #71154].

=item *

Causing C<@DB::args> to be freed between uses of C<caller> no longer
results in a crash [perl #93320].

=item *

C<setpgrp($foo)> used to be equivalent to C<($foo, setpgrp)>, because
C<setpgrp> was ignoring its argument if there was just one.  Now it is
equivalent to C<setpgrp($foo,0)>.

=item *

C<shmread> was not setting the scalar flags correctly when reading from
shared memory, causing the existing cached numeric representation in the
scalar to persist [perl #98480].

=item *

C<++> and C<--> now work on copies of globs, instead of dying.

=item *

C<splice()> doesn't warn when truncating

You can now limit the size of an array using C<splice(@a,MAX_LEN)> without
worrying about warnings.

=item *

C<< $$ >> is no longer tainted.  Since this value comes directly from
C<< getpid() >>, it is always safe.

=item *

The parser no longer leaks a filehandle if STDIN was closed before parsing
started [perl #37033].

=item *

C<< die; >> with a non-reference, non-string, or magical (e.g., tainted)
value in $@ now properly propagates that value [perl #111654].

=back

=head1 Known Problems

=over 4

=item *

On Solaris, we have two kinds of failure.

If F<make> is Sun's F<make≥>, we get an error about a badly formed macro
assignment in the F<Makefile>.  That happens when F<./Configure> tries to
make depends.  F<Configure> then exits  0, but further F<make>-ing fails.

If F<make> is F<gmake>, F<Configure> completes, then we get errors related
to F</usr/include/stdbool.h>

=item *

The following CPAN modules have test failures with perl 5.16.  Patches have
been submitted for all of these, so hopefully there will be new releases
soon:

=over

=item *

L<Date::Pcalc> version 6.1

=item *

L<Module::CPANTS::Analyse> version 0.85

This fails due to problems in L<Module::Find> 0.10 and L<File::MMagic>
1.27.

=item *

L<PerlIO::Util> version 0.72

=back

=back

=head1 Acknowledgements

XXX Generate this with:

  perl Porting/acknowledgements.pl v5.14.0..HEAD

=head1 Reporting Bugs

If you find what you think is a bug, you might check the articles
recently posted to the comp.lang.perl.misc newsgroup and the perl
bug database at L<http://rt.perl.org/perlbug/>.  There may also be
information at L<http://www.perl.org/>, the Perl Home Page.

If you believe you have an unreported bug, please run the L<perlbug>
program included with your release.  Be sure to trim your bug down
to a tiny but sufficient test case.  Your bug report, along with the
output of C<perl -V>, will be sent off to perlbug@perl.org to be
analysed by the Perl porting team.

If the bug you are reporting has security implications, which make it
inappropriate to send to a publicly archived mailing list, then please
send it to perl5-security-report@perl.org.  This points to a closed
subscription unarchived mailing list, which includes all the core
committers, who will be able to help assess the impact of issues, figure
out a resolution, and help co-ordinate the release of patches to
mitigate or fix the problem across all platforms on which Perl is
supported.  Please only use this address for security issues in the Perl
core, not for modules independently distributed on CPAN.

=head1 SEE ALSO

The F<Changes> file for an explanation of how to view exhaustive details
on what changed.

The F<INSTALL> file for how to build Perl.

The F<README> file for general stuff.

The F<Artistic> and F<Copying> files for copyright information.

=cut
